/**
 * Parse JavaScript SDK v2.2.1
 *
 * Copyright (c) 2015-present, Parse, LLC.
 * All rights reserved.
 *
 * The source tree of this library can be found at
 *   https://github.com/ParsePlatform/Parse-SDK-JS
 * This source code is licensed under the BSD-style license found in the
 * LICENSE file in the root directory of this source tree. An additional grant
 * of patent rights can be found in the PATENTS file in the same directory.
 */
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Parse=e()}}(function(){return function i(o,s,u){function l(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}var a=s[t]={exports:{}};o[t][0].call(a.exports,function(e){return l(o[t][1][e]||e)},a,a.exports,i,o,s,u)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)l(u[e]);return l}({1:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.track=function(e,t){if(0===(e=(e=(e=e||"").replace(/^\s*/,"")).replace(/\s*$/,"")).length)throw new TypeError("A name for the custom event must be provided");for(var r in t)if("string"!=typeof r||"string"!=typeof t[r])throw new TypeError('track() dimensions expects keys and values of type "string".');return a.default.getAnalyticsController().track(e,t)};var a=n(e("./CoreManager"));var i={track:function(e,t){return a.default.getRESTController().request("POST","events/"+e,{dimensions:t})}};a.default.setAnalyticsController(i)},{"./CoreManager":3,"@babel/runtime/helpers/interopRequireDefault":58}],2:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.run=function(e,t,r){if(r=r||{},"string"!=typeof e||0===e.length)throw new TypeError("Cloud function name must be a string.");var n={};r.useMasterKey&&(n.useMasterKey=r.useMasterKey);r.sessionToken&&(n.sessionToken=r.sessionToken);return o.default.getCloudController().run(e,t,n)},r.getJobsData=function(){return o.default.getCloudController().getJobsData({useMasterKey:!0})},r.startJob=function(e,t){if("string"==typeof e&&0!==e.length)return o.default.getCloudController().startJob(e,t,{useMasterKey:!0});throw new TypeError("Cloud job name must be a string.")},r.getJobStatus=function(e){return new a.default("_JobStatus").get(e,{useMasterKey:!0})};var i=n(e("@babel/runtime/helpers/typeof")),o=n(e("./CoreManager")),s=n(e("./decode")),u=n(e("./encode")),l=n(e("./ParseError")),a=n(e("./ParseQuery"));var c={run:function(e,t,r){var n=o.default.getRESTController(),a=(0,u.default)(t,!0);return n.request("POST","functions/"+e,a,r).then(function(e){if("object"===(0,i.default)(e)&&0<Object.keys(e).length&&!e.hasOwnProperty("result"))throw new l.default(l.default.INVALID_JSON,"The server returned an invalid response.");var t=(0,s.default)(e);return t&&t.hasOwnProperty("result")?Promise.resolve(t.result):Promise.resolve(void 0)})},getJobsData:function(e){return o.default.getRESTController().request("GET","cloud_code/jobs/data",null,e)},startJob:function(e,t,r){var n=o.default.getRESTController(),a=(0,u.default)(t,!0);return n.request("POST","jobs/"+e,a,r)}};o.default.setCloudController(c)},{"./CoreManager":3,"./ParseError":16,"./ParseQuery":24,"./decode":39,"./encode":40,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],3:[function(e,n,t){(function(e){"use strict";var r={IS_NODE:void 0!==e&&!!e.versions&&!!e.versions.node&&!e.versions.electron,REQUEST_ATTEMPT_LIMIT:5,SERVER_URL:"https://api.parse.com/1",LIVEQUERY_SERVER_URL:null,VERSION:"js2.2.1",APPLICATION_ID:null,JAVASCRIPT_KEY:null,MASTER_KEY:null,USE_MASTER_KEY:!1,PERFORM_USER_REWRITE:!0,FORCE_REVOCABLE_SESSION:!1};function t(t,e,r){e.forEach(function(e){if("function"!=typeof r[e])throw new Error("".concat(t," must implement ").concat(e,"()"))})}n.exports={get:function(e){if(r.hasOwnProperty(e))return r[e];throw new Error("Configuration key not found: "+e)},set:function(e,t){r[e]=t},setAnalyticsController:function(e){t("AnalyticsController",["track"],e),r.AnalyticsController=e},getAnalyticsController:function(){return r.AnalyticsController},setCloudController:function(e){t("CloudController",["run","getJobsData","startJob"],e),r.CloudController=e},getCloudController:function(){return r.CloudController},setConfigController:function(e){t("ConfigController",["current","get","save"],e),r.ConfigController=e},getConfigController:function(){return r.ConfigController},setFileController:function(e){t("FileController",["saveFile","saveBase64"],e),r.FileController=e},getFileController:function(){return r.FileController},setInstallationController:function(e){t("InstallationController",["currentInstallationId"],e),r.InstallationController=e},getInstallationController:function(){return r.InstallationController},setObjectController:function(e){t("ObjectController",["save","fetch","destroy"],e),r.ObjectController=e},getObjectController:function(){return r.ObjectController},setObjectStateController:function(e){t("ObjectStateController",["getState","initializeState","removeState","getServerData","setServerData","getPendingOps","setPendingOp","pushPendingState","popPendingState","mergeFirstPendingState","getObjectCache","estimateAttribute","estimateAttributes","commitServerChanges","enqueueTask","clearAllState"],e),r.ObjectStateController=e},getObjectStateController:function(){return r.ObjectStateController},setPushController:function(e){t("PushController",["send"],e),r.PushController=e},getPushController:function(){return r.PushController},setQueryController:function(e){t("QueryController",["find","aggregate"],e),r.QueryController=e},getQueryController:function(){return r.QueryController},setRESTController:function(e){t("RESTController",["request","ajax"],e),r.RESTController=e},getRESTController:function(){return r.RESTController},setSchemaController:function(e){t("SchemaController",["get","create","update","delete","send","purge"],e),r.SchemaController=e},getSchemaController:function(){return r.SchemaController},setSessionController:function(e){t("SessionController",["getSession"],e),r.SessionController=e},getSessionController:function(){return r.SessionController},setStorageController:function(e){e.async?t("An async StorageController",["getItemAsync","setItemAsync","removeItemAsync"],e):t("A synchronous StorageController",["getItem","setItem","removeItem"],e),r.StorageController=e},setLocalDatastoreController:function(e){t("LocalDatastoreController",["pinWithName","fromPinWithName","unPinWithName","getAllContents","clear"],e),r.LocalDatastoreController=e},getLocalDatastoreController:function(){return r.LocalDatastoreController},setLocalDatastore:function(e){r.LocalDatastore=e},getLocalDatastore:function(){return r.LocalDatastore},getStorageController:function(){return r.StorageController},setAsyncStorage:function(e){r.AsyncStorage=e},getAsyncStorage:function(){return r.AsyncStorage},setUserController:function(e){t("UserController",["setCurrentUser","currentUser","currentUserAsync","signUp","logIn","become","logOut","requestPasswordReset","upgradeToRevocableSession","linkWith"],e),r.UserController=e},getUserController:function(){return r.UserController},setLiveQueryController:function(e){t("LiveQueryController",["subscribe","unsubscribe","open","close"],e),r.LiveQueryController=e},getLiveQueryController:function(){return r.LiveQueryController},setHooksController:function(e){t("HooksController",["create","get","update","remove"],e),r.HooksController=e},getHooksController:function(){return r.HooksController}}}).call(this,e("_process"))},{_process:70}],4:[function(e,t,r){"use strict";t.exports=e("events").EventEmitter},{events:71}],5:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i,s,u=n(e("./parseDate")),a=n(e("./ParseUser")),o=!1,l={authenticate:function(t){var r=this;"undefined"==typeof FB&&t.error(this,"Facebook SDK not found."),FB.login(function(e){e.authResponse?t.success&&t.success(r,{id:e.authResponse.userID,access_token:e.authResponse.accessToken,expiration_date:new Date(1e3*e.authResponse.expiresIn+(new Date).getTime()).toJSON()}):t.error&&t.error(r,e)},{scope:i})},restoreAuthentication:function(e){if(e){var t=(0,u.default)(e.expiration_date),r=t?(t.getTime()-(new Date).getTime())/1e3:0,n={userID:e.id,accessToken:e.access_token,expiresIn:r},a={};if(s)for(var i in s)a[i]=s[i];a.authResponse=n,a.status=!1;var o=FB.getAuthResponse();o&&o.userID!==n.userID&&FB.logout(),FB.init(a)}return!0},getAuthType:function(){return"facebook"},deauthenticate:function(){this.restoreAuthentication(null)}},c={init:function(e){if("undefined"==typeof FB)throw new Error("The Facebook JavaScript SDK must be loaded before calling init.");if(s={},e)for(var t in e)s[t]=e[t];s.status&&"undefined"!=typeof console&&(console.warn||console.log||function(){}).call(console,'The "status" flag passed into FB.init, when set to true, can interfere with Parse Facebook integration, so it has been suppressed. Please call FB.getLoginStatus() explicitly if you require this behavior.');s.status=!1,FB.init(s),a.default._registerAuthenticationProvider(l),o=!0},isLinked:function(e){return e._isLinked("facebook")},logIn:function(e,t){if(e&&"string"!=typeof e){var r={};if(t)for(var n in t)r[n]=t[n];return r.authData=e,a.default._logInWith("facebook",r)}if(!o)throw new Error("You must initialize FacebookUtils before calling logIn.");return i=e,a.default._logInWith("facebook",t)},link:function(e,t,r){if(t&&"string"!=typeof t){var n={};if(r)for(var a in r)n[a]=r[a];return n.authData=t,e._linkWith("facebook",n)}if(!o)throw new Error("You must initialize FacebookUtils before calling link.");return i=t,e._linkWith("facebook",r)},unlink:function(e,t){if(!o)throw new Error("You must initialize FacebookUtils before calling unlink.");return e._unlinkFrom("facebook",t)}};r.default=c},{"./ParseUser":29,"./parseDate":44,"@babel/runtime/helpers/interopRequireDefault":58}],6:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault")(e("./Storage")),a=null;function i(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}var o={currentInstallationId:function(){if("string"==typeof a)return Promise.resolve(a);var t=n.default.generatePath("installationId");return n.default.getItemAsync(t).then(function(e){return e?a=e:(e=i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i(),n.default.setItemAsync(t,e).then(function(){return a=e}))})},_clearCache:function(){a=null},_setInstallationIdCache:function(e){a=e}};t.exports=o},{"./Storage":33,"@babel/runtime/helpers/interopRequireDefault":58}],7:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/typeof")),u=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/createClass")),l=n(e("@babel/runtime/helpers/possibleConstructorReturn")),c=n(e("@babel/runtime/helpers/getPrototypeOf")),o=n(e("@babel/runtime/helpers/inherits")),f=n(e("@babel/runtime/helpers/assertThisInitialized")),d=n(e("@babel/runtime/helpers/defineProperty")),h=n(e("./CoreManager")),s=n(e("./EventEmitter")),p=n(e("./ParseObject")),v=n(e("./LiveQuerySubscription")),y=e("./promiseUtils"),b="initialized",m="connecting",g="connected",_="closed",w="reconnecting",P="disconnected",O="connect",k="subscribe",C="unsubscribe",S="connected",E="subscribed",A="unsubscribed",N="error",I="close",R="error",T="open",j="open",x="close",D="error",L=function(e){function s(e){var t,r=e.applicationId,n=e.serverURL,a=e.javascriptKey,i=e.masterKey,o=e.sessionToken;if((0,u.default)(this,s),t=(0,l.default)(this,(0,c.default)(s).call(this)),(0,d.default)((0,f.default)((0,f.default)(t)),"attempts",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"id",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"requestId",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"applicationId",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"serverURL",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"javascriptKey",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"masterKey",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"sessionToken",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"connectPromise",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"subscriptions",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"socket",void 0),(0,d.default)((0,f.default)((0,f.default)(t)),"state",void 0),!n||0!==n.indexOf("ws"))throw new Error("You need to set a proper Parse LiveQuery server url before using LiveQueryClient");return t.reconnectHandle=null,t.attempts=1,t.id=0,t.requestId=1,t.serverURL=n,t.applicationId=r,t.javascriptKey=a,t.masterKey=i,t.sessionToken=o,t.connectPromise=(0,y.resolvingPromise)(),t.subscriptions=new Map,t.state=b,t}return(0,o.default)(s,e),(0,i.default)(s,[{key:"shouldOpen",value:function(){return this.state===b||this.state===P}},{key:"subscribe",value:function(e,t){var r=this;if(e){var n=e.className,a=e.toJSON(),i=a.where,o=a.keys?a.keys.split(","):void 0,s={op:k,requestId:this.requestId,query:{className:n,where:i,fields:o}};t&&(s.sessionToken=t);var u=new v.default(this.requestId,e,t);return this.subscriptions.set(this.requestId,u),this.requestId+=1,this.connectPromise.then(function(){r.socket.send(JSON.stringify(s))}),u.on("error",function(){}),u}}},{key:"unsubscribe",value:function(e){var t=this;if(e){this.subscriptions.delete(e.id);var r={op:C,requestId:e.id};this.connectPromise.then(function(){t.socket.send(JSON.stringify(r))})}}},{key:"open",value:function(){var t=this,e=this._getWebSocketImplementation();e?(this.state!==w&&(this.state=m),this.socket=new e(this.serverURL),this.socket.onopen=function(){t._handleWebSocketOpen()},this.socket.onmessage=function(e){t._handleWebSocketMessage(e)},this.socket.onclose=function(){t._handleWebSocketClose()},this.socket.onerror=function(e){t._handleWebSocketError(e)}):this.emit(R,"Can not find WebSocket implementation")}},{key:"resubscribe",value:function(){var l=this;this.subscriptions.forEach(function(e,t){var r=e.query,n=r.toJSON(),a=n.where,i=n.keys?n.keys.split(","):void 0,o=r.className,s=e.sessionToken,u={op:k,requestId:t,query:{className:o,where:a,fields:i}};s&&(u.sessionToken=s),l.connectPromise.then(function(){l.socket.send(JSON.stringify(u))})})}},{key:"close",value:function(){if(this.state!==b&&this.state!==P){this.state=P,this.socket.close();var e=!0,t=!1,r=void 0;try{for(var n,a=this.subscriptions.values()[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){n.value.emit(x)}}catch(e){t=!0,r=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw r}}this._handleReset(),this.emit(I)}}},{key:"_getWebSocketImplementation",value:function(){return"function"==typeof WebSocket||"object"===("undefined"==typeof WebSocket?"undefined":(0,a.default)(WebSocket))?WebSocket:null}},{key:"_handleReset",value:function(){this.attempts=1,this.id=0,this.requestId=1,this.connectPromise=(0,y.resolvingPromise)(),this.subscriptions=new Map}},{key:"_handleWebSocketOpen",value:function(){this.attempts=1;var e={op:O,applicationId:this.applicationId,javascriptKey:this.javascriptKey,masterKey:this.masterKey,sessionToken:this.sessionToken};this.socket.send(JSON.stringify(e))}},{key:"_handleWebSocketMessage",value:function(e){var t=e.data;"string"==typeof t&&(t=JSON.parse(t));var r=null;switch(t.requestId&&(r=this.subscriptions.get(t.requestId)),t.op){case S:this.state===w&&this.resubscribe(),this.emit(T),this.id=t.clientId,this.connectPromise.resolve(),this.state=g;break;case E:r&&r.emit(j);break;case N:t.requestId?r&&r.emit(D,t.error):this.emit(R,t.error);break;case A:break;default:if(!r)break;var n=!1;if(t.original){for(var a in n=!0,delete t.original.__type,t.original)a in t.object||(t.object[a]=void 0);t.original=p.default.fromJSON(t.original,!1)}delete t.object.__type;var i=p.default.fromJSON(t.object,n);r.emit(t.op,i,t.original);var o=h.default.getLocalDatastore();n&&o.isEnabled&&o._updateObjectIfPinned(i).then(function(){})}}},{key:"_handleWebSocketClose",value:function(){if(this.state!==P){this.state=_,this.emit(I);var e=!0,t=!1,r=void 0;try{for(var n,a=this.subscriptions.values()[Symbol.iterator]();!(e=(n=a.next()).done);e=!0){n.value.emit(x)}}catch(e){t=!0,r=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw r}}this._handleReconnect()}}},{key:"_handleWebSocketError",value:function(e){this.emit(R,e);var t=!0,r=!1,n=void 0;try{for(var a,i=this.subscriptions.values()[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){a.value.emit(D)}}catch(e){r=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(r)throw n}}this._handleReconnect()}},{key:"_handleReconnect",value:function(){var e=this;if(this.state!==P){this.state=w;var t,r=(t=this.attempts,Math.random()*Math.min(30,Math.pow(2,t)-1)*1e3);this.reconnectHandle&&clearTimeout(this.reconnectHandle),this.reconnectHandle=setTimeout(function(){e.attempts++,e.connectPromise=(0,y.resolvingPromise)(),e.open()}.bind(this),r)}}}]),s}(s.default);r.default=L},{"./CoreManager":3,"./EventEmitter":4,"./LiveQuerySubscription":8,"./ParseObject":21,"./promiseUtils":45,"@babel/runtime/helpers/assertThisInitialized":49,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/getPrototypeOf":56,"@babel/runtime/helpers/inherits":57,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/possibleConstructorReturn":63,"@babel/runtime/helpers/typeof":67}],8:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/classCallCheck")),o=n(e("@babel/runtime/helpers/createClass")),s=n(e("@babel/runtime/helpers/possibleConstructorReturn")),u=n(e("@babel/runtime/helpers/getPrototypeOf")),l=n(e("@babel/runtime/helpers/inherits")),a=n(e("./EventEmitter")),c=n(e("./CoreManager")),f=function(e){function a(e,t,r){var n;return(0,i.default)(this,a),(n=(0,s.default)(this,(0,u.default)(a).call(this))).id=e,n.query=t,n.sessionToken=r,n}return(0,l.default)(a,e),(0,o.default)(a,[{key:"unsubscribe",value:function(){var t=this;return c.default.getLiveQueryController().getDefaultLiveQueryClient().then(function(e){e.unsubscribe(t),t.emit("close")})}}]),a}(a.default);r.default=f},{"./CoreManager":3,"./EventEmitter":4,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/getPrototypeOf":56,"@babel/runtime/helpers/inherits":57,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/possibleConstructorReturn":63}],9:[function(e,t,r){"use strict";var n,a,i,o,s,u,l,c=e("@babel/runtime/helpers/interopRequireDefault"),p=c(e("@babel/runtime/regenerator")),f=c(e("@babel/runtime/helpers/toConsumableArray")),d=c(e("@babel/runtime/helpers/asyncToGenerator")),h=c(e("./CoreManager")),v="_default",y="parsePin_",b={fromPinWithName:function(e){return h.default.getLocalDatastoreController().fromPinWithName(e)},pinWithName:function(e,t){return h.default.getLocalDatastoreController().pinWithName(e,t)},unPinWithName:function(e){return h.default.getLocalDatastoreController().unPinWithName(e)},_getAllContents:function(){return h.default.getLocalDatastoreController().getAllContents()},_clear:function(){return h.default.getLocalDatastoreController().clear()},_handlePinWithName:(l=(0,d.default)(p.default.mark(function e(t,r){var n,a,i,o,s,u;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.getPinName(t),(a=this._getChildren(r))[this.getKeyForObject(r)]=r._toFullJSON(),e.t0=p.default.keys(a);case 4:if((e.t1=e.t0()).done){e.next=10;break}return i=e.t1.value,e.next=8,this.pinWithName(i,a[i]);case 8:e.next=4;break;case 10:return e.next=12,this.fromPinWithName(n);case 12:if(e.t2=e.sent,e.t2){e.next=15;break}e.t2=[];case 15:return o=e.t2,s=Object.keys(a),u=(0,f.default)(new Set([].concat((0,f.default)(o),(0,f.default)(s)))),e.next=20,this.pinWithName(n,u);case 20:case"end":return e.stop()}},e,this)})),function(){return l.apply(this,arguments)}),_handleUnPinWithName:(u=(0,d.default)(p.default.mark(function e(t,r){var n,a,i,o,s,u,l,c,f;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getAllContents();case 2:if(n=e.sent,a=this.getPinName(t),i=this._getChildren(r),(o=Object.keys(i)).push(this.getKeyForObject(r)),0==(s=(s=n[a]||[]).filter(function(e){return!o.includes(e)})).length)return e.next=12,this.unPinWithName(a);e.next=15;break;case 12:delete n[a],e.next=18;break;case 15:return e.next=17,this.pinWithName(a,s);case 17:n[a]=s;case 18:u=0;case 19:if(!(u<o.length)){e.next=38;break}l=o[u],c=!1,e.t0=p.default.keys(n);case 23:if((e.t1=e.t0()).done){e.next=32;break}if((f=e.t1.value)!==v&&!f.startsWith(y)){e.next=30;break}if((n[f]||[]).includes(l))return c=!0,e.abrupt("break",32);e.next=30;break;case 30:e.next=23;break;case 32:if(c){e.next=35;break}return e.next=35,this.unPinWithName(l);case 35:u++,e.next=19;break;case 38:case"end":return e.stop()}},e,this)})),function(){return u.apply(this,arguments)}),_getChildren:function(e){var t={},r=e._toFullJSON();for(var n in r)r[n].__type&&"Object"===r[n].__type&&this._traverse(r[n],t);return t},_traverse:function(e,t){if(e.objectId){var r=this.getKeyForObject(e);if(!t[r])for(var n in t[r]=e){var a=e[n];e[n]||(a=e),a.__type&&"Object"===a.__type&&this._traverse(a,t)}}},_serializeObjectsFromPinName:(s=(0,d.default)(p.default.mark(function e(t){var r,n,a,i,o,s,u=this;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._getAllContents();case 2:for(a in r=e.sent,n=[],r)a===v||a.startsWith(y)||n.push(r[a]);if(t){e.next=7;break}return e.abrupt("return",Promise.resolve(n));case 7:return e.next=9,this.getPinName(t);case 9:return i=e.sent,e.next=12,this.fromPinWithName(i);case 12:if(o=e.sent,Array.isArray(o)){e.next=15;break}return e.abrupt("return",Promise.resolve([]));case 15:return s=o.map(function(){var e=(0,d.default)(p.default.mark(function e(t){return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.fromPinWithName(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()),e.abrupt("return",Promise.all(s));case 17:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)}),_serializeObject:(o=(0,d.default)(p.default.mark(function e(t,r){var n,a,i,o,s,u,l,c,f,d,h;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r){e.next=5;break}return e.next=4,this._getAllContents();case 4:n=e.sent;case 5:if(a=n[t]){e.next=8;break}return e.abrupt("return",null);case 8:for(i=[],(o={})[s=0]=a,i.push(s);0!==i.length;)for(c in u=i.shift(),l=o[u])(f=l[c]).__type&&"Object"===f.__type&&(d=this.getKeyForObject(f),(h=n[d])&&(o[++s]=h,l[c]=h,i.push(s)));return e.abrupt("return",a);case 15:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)}),_updateObjectIfPinned:(i=(0,d.default)(p.default.mark(function e(t){var r;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:return r=this.getKeyForObject(t),e.next=5,this.fromPinWithName(r);case 5:if(e.sent)return e.next=9,this.pinWithName(r,t._toFullJSON());e.next=9;break;case 9:case"end":return e.stop()}},e,this)})),function(){return i.apply(this,arguments)}),_destroyObjectIfPinned:(a=(0,d.default)(p.default.mark(function e(t){var r,n,a,i;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this._getAllContents();case 4:if(r=e.sent,n=this.getKeyForObject(t),r[n]){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this.unPinWithName(n);case 11:delete r[n],e.t0=p.default.keys(r);case 13:if((e.t1=e.t0()).done){e.next=30;break}if((a=e.t1.value)!==v&&!a.startsWith(y)){e.next=28;break}if(!(i=r[a]||[]).includes(n)){e.next=28;break}if(0==(i=i.filter(function(e){return e!==n})).length)return e.next=22,this.unPinWithName(a);e.next=25;break;case 22:delete r[a],e.next=28;break;case 25:return e.next=27,this.pinWithName(a,i);case 27:r[a]=i;case 28:e.next=13;break;case 30:case"end":return e.stop()}},e,this)})),function(){return a.apply(this,arguments)}),_updateLocalIdForObject:(n=(0,d.default)(p.default.mark(function e(t,r){var n,a,i,o,s,u;return p.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isEnabled){e.next=2;break}return e.abrupt("return");case 2:return n="".concat(r.className,"_").concat(t),a=this.getKeyForObject(r),e.next=6,this.fromPinWithName(n);case 6:if(i=e.sent){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this.unPinWithName(n);case 11:return e.next=13,this.pinWithName(a,i);case 13:return e.next=15,this._getAllContents();case 15:o=e.sent,e.t0=p.default.keys(o);case 17:if((e.t1=e.t0()).done){e.next=29;break}if((s=e.t1.value)!==v&&!s.startsWith(y)){e.next=27;break}if((u=o[s]||[]).includes(n))return(u=u.filter(function(e){return e!==n})).push(a),e.next=26,this.pinWithName(s,u);e.next=27;break;case 26:o[s]=u;case 27:e.next=17;break;case 29:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)}),getKeyForObject:function(e){var t=e.objectId||e._getId();return"".concat(e.className,"_").concat(t)},getPinName:function(e){return e&&e!==v?y+e:v},checkIfEnabled:function(){return this.isEnabled||console.log("Parse.enableLocalDatastore() must be called first"),this.isEnabled}};b.DEFAULT_PIN=v,b.PIN_PREFIX=y,b.isEnabled=!1,t.exports=b,h.default.setLocalDatastoreController(e("./LocalDatastoreController.browser")),h.default.setLocalDatastore(b)},{"./CoreManager":3,"./LocalDatastoreController.browser":10,"@babel/runtime/helpers/asyncToGenerator":50,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/toConsumableArray":66,"@babel/runtime/regenerator":69}],10:[function(e,t,r){"use strict";var n={fromPinWithName:function(e){var t=localStorage.getItem(e);if(!t)return Promise.resolve(null);var r=JSON.parse(t);return Promise.resolve(r)},pinWithName:function(e,t){try{var r=JSON.stringify(t);localStorage.setItem(e,r)}catch(e){console.log(e.message)}return Promise.resolve()},unPinWithName:function(e){return Promise.resolve(localStorage.removeItem(e))},getAllContents:function(){for(var e={},t=0;t<localStorage.length;t+=1){var r=localStorage.key(t),n=localStorage.getItem(r);e[r]=JSON.parse(n)}return Promise.resolve(e)},clear:function(){return Promise.resolve(localStorage.clear())}};t.exports=n},{}],11:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.defaultState=function(){return{serverData:{},pendingOps:[{}],objectCache:{},tasks:new a.default,existed:!1}},r.setServerData=function(e,t){for(var r in t)void 0!==t[r]?e[r]=t[r]:delete e[r]},r.setPendingOp=function(e,t,r){var n=e.length-1;r?e[n][t]=r:delete e[n][t]},r.pushPendingState=function(e){e.push({})},r.popPendingState=i,r.mergeFirstPendingState=function(e){var t=i(e),r=e[0];for(var n in t)if(r[n]&&t[n]){var a=r[n].mergeWith(t[n]);a&&(r[n]=a)}else r[n]=t[n]},r.estimateAttribute=function(e,t,r,n,a){for(var i=e[a],o=0;o<t.length;o++)t[o][a]&&(t[o][a]instanceof f.RelationOp?n&&(i=t[o][a].applyTo(i,{className:r,id:n},a)):i=t[o][a].applyTo(i));return i},r.estimateAttributes=function(e,t,r,n){var a={};for(var i in e)a[i]=e[i];for(var o=0;o<t.length;o++)for(i in t[o])if(t[o][i]instanceof f.RelationOp)n&&(a[i]=t[o][i].applyTo(a[i],{className:r,id:n},i));else if(i.includes(".")){for(var s=i.split("."),u=s[s.length-1],l=Object.assign({},a),c=0;c<s.length-1;c++)l=l[s[c]];l[u]=t[o][i].applyTo(l[u])}else a[i]=t[o][i].applyTo(a[i]);return a},r.commitServerChanges=function(e,t,r){for(var n in r){var a=r[n];if((e[n]=a)&&"object"===(0,o.default)(a)&&!(a instanceof l.default)&&!(a instanceof u.default)&&!(a instanceof c.default)){var i=(0,s.default)(a,!1,!0);t[n]=JSON.stringify(i)}}};var o=n(e("@babel/runtime/helpers/typeof")),s=n(e("./encode")),u=n(e("./ParseFile")),l=n(e("./ParseObject")),c=n(e("./ParseRelation")),a=n(e("./TaskQueue")),f=e("./ParseOp");function i(e){var t=e.shift();return e.length||(e[0]={}),t}},{"./ParseFile":17,"./ParseObject":21,"./ParseOp":22,"./ParseRelation":25,"./TaskQueue":35,"./encode":40,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],12:[function(e,t,r){"use strict";var F=e("@babel/runtime/helpers/interopRequireDefault")(e("@babel/runtime/helpers/typeof")),W=e("./equals").default,K=e("./decode").default,J=e("./ParseError").default,Q=e("./ParsePolygon").default,$=e("./ParseGeoPoint").default;function G(e,t){if(!t||!t.__type||"Pointer"!==t.__type&&"Object"!==t.__type)return-1<e.indexOf(t);for(var r in e){var n=e[r];if("string"==typeof n&&n===t.objectId)return!0;if(n.className===t.className&&n.objectId===t.objectId)return!0}return!1}function V(e){return e._toFullJSON?e._toFullJSON():e}function z(e,t,r,n){if(t.className!==e)return!1;var a=t,i=n;for(var o in t.toJSON&&(a=t.toJSON()),n.toJSON&&(i=n.toJSON().where),a.className=e,i)if(!Y(e,a,r,o,i[o]))return!1;return!0}function B(e,t,r){if(Array.isArray(e)){for(var n=0;n<e.length;n++)if(r(e[n],t))return!0;return!1}return r(e,t)}function Y(e,t,r,n,a){if(null===a)return!1;if(0<=n.indexOf(".")){var i=n.split("."),o=i[0],s=i.slice(1).join(".");return Y(e,t[o]||{},r,s,a)}var u,l;if("$or"===n){for(u=0;u<a.length;u++)if(z(e,t,r,a[u]))return!0;return!1}if("$and"===n){for(u=0;u<a.length;u++)if(!z(e,t,r,a[u]))return!1;return!0}if("$nor"===n){for(u=0;u<a.length;u++)if(z(e,t,r,a[u]))return!1;return!0}if("$relatedTo"===n)return!1;if(!/^[A-Za-z][0-9A-Za-z_]*$/.test(n))throw new J(J.INVALID_KEY_NAME,"Invalid Key: ".concat(n));if("object"!==(0,F.default)(a))return Array.isArray(t[n])?-1<t[n].indexOf(a):t[n]===a;if(a.__type)return"Pointer"===a.__type?B(t[n],a,function(e,t){return void 0!==e&&t.className===e.className&&t.objectId===e.objectId}):B(K(t[n]),K(a),W);for(var c in a)switch((l=a[c]).__type&&(l=K(l)),"[object Date]"===toString.call(l)&&(t[n]=new Date(t[n])),c){case"$lt":if(t[n]>=l)return!1;break;case"$lte":if(t[n]>l)return!1;break;case"$gt":if(t[n]<=l)return!1;break;case"$gte":if(t[n]<l)return!1;break;case"$ne":if(W(t[n],l))return!1;break;case"$in":if(!G(l,t[n]))return!1;break;case"$nin":if(G(l,t[n]))return!1;break;case"$all":for(u=0;u<l.length;u++)if(t[n].indexOf(l[u])<0)return!1;break;case"$exists":var f=void 0!==t[n],d=a.$exists;if("boolean"!=typeof a.$exists)break;if(!f&&d||f&&!d)return!1;break;case"$regex":if("object"===(0,F.default)(l))return l.test(t[n]);for(var h="",p=-2,v=l.indexOf("\\Q");-1<v;)h+=l.substring(p+2,v),-1<(p=l.indexOf("\\E",v))&&(h+=l.substring(v+2,p).replace(/\\\\\\\\E/g,"\\E").replace(/\W/g,"\\$&")),v=l.indexOf("\\Q",p);h+=l.substring(Math.max(v,p+2));var y=a.$options||"";if(y=y.replace("x","").replace("s",""),!new RegExp(h,y).test(t[n]))return!1;break;case"$nearSphere":return!(!l||!t[n])&&l.radiansTo(t[n])<=(a.$maxDistance||1/0);case"$within":if(!l||!t[n])return!1;var b=l.$box[0],m=l.$box[1];return!(b.latitude>m.latitude||b.longitude>m.longitude)&&(t[n].latitude>b.latitude&&t[n].latitude<m.latitude&&t[n].longitude>b.longitude&&t[n].longitude<m.longitude);case"$options":case"$maxDistance":break;case"$select":for(var g=r.filter(function(e,t,r){return z(l.query.className,e,r,l.query.where)}),_=0;_<g.length;_+=1){var w=V(g[_]);return W(t[n],w[l.key])}return!1;case"$dontSelect":for(var P=r.filter(function(e,t,r){return z(l.query.className,e,r,l.query.where)}),O=0;O<P.length;O+=1){var k=V(P[O]);return!W(t[n],k[l.key])}return!1;case"$inQuery":for(var C=r.filter(function(e,t,r){return z(l.className,e,r,l.where)}),S=0;S<C.length;S+=1){var E=V(C[S]);if(t[n].className===E.className&&t[n].objectId===E.objectId)return!0}return!1;case"$notInQuery":for(var A=r.filter(function(e,t,r){return z(l.className,e,r,l.where)}),N=0;N<A.length;N+=1){var I=V(A[N]);if(t[n].className===I.className&&t[n].objectId===I.objectId)return!1}return!0;case"$containedBy":var R=!0,T=!1,j=void 0;try{for(var x,D=t[n][Symbol.iterator]();!(R=(x=D.next()).done);R=!0){var L=x.value;if(!G(l,L))return!1}}catch(e){T=!0,j=e}finally{try{R||null==D.return||D.return()}finally{if(T)throw j}}return!0;case"$geoWithin":var M=l.$polygon.map(function(e){return[e.latitude,e.longitude]});return new Q(M).containsPoint(t[n]);case"$geoIntersects":var q=new Q(t[n].coordinates),U=new $(l.$point);return q.containsPoint(U);default:return!1}return!0}var n={matchesQuery:z,validateQuery:function(e){var t=e;e.toJSON&&(t=e.toJSON().where);var r=["$and","$or","$nor","_rperm","_wperm","_perishable_token","_email_verify_token","_email_verify_token_expires_at","_account_lockout_expires_at","_failed_login_count"];Object.keys(t).forEach(function(e){if(t&&t[e]&&t[e].$regex&&"string"==typeof t[e].$options&&!t[e].$options.match(/^[imxs]+$/))throw new J(J.INVALID_QUERY,"Bad $options value for query: ".concat(t[e].$options));if(r.indexOf(e)<0&&!e.match(/^[a-zA-Z][a-zA-Z0-9_\.]*$/))throw new J(J.INVALID_KEY_NAME,"Invalid key name: ".concat(e))})}};t.exports=n},{"./ParseError":16,"./ParseGeoPoint":18,"./ParsePolygon":23,"./decode":39,"./equals":41,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],13:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireWildcard"),a=e("@babel/runtime/helpers/interopRequireDefault"),i=a(e("./decode")),o=a(e("./encode")),s=a(e("./CoreManager")),u=a(e("./InstallationController")),l=n(e("./ParseOp")),c=a(e("./RESTController")),f={initialize:function(e,t){s.default.get("IS_NODE")&&console.log("It looks like you're using the browser version of the SDK in a node.js environment. You should require('parse/node') instead."),f._initialize(e,t)},_initialize:function(e,t,r){s.default.set("APPLICATION_ID",e),s.default.set("JAVASCRIPT_KEY",t),s.default.set("MASTER_KEY",r),s.default.set("USE_MASTER_KEY",!1)},setAsyncStorage:function(e){s.default.setAsyncStorage(e)},setLocalDatastoreController:function(e){s.default.setLocalDatastoreController(e)}};Object.defineProperty(f,"applicationId",{get:function(){return s.default.get("APPLICATION_ID")},set:function(e){s.default.set("APPLICATION_ID",e)}}),Object.defineProperty(f,"javaScriptKey",{get:function(){return s.default.get("JAVASCRIPT_KEY")},set:function(e){s.default.set("JAVASCRIPT_KEY",e)}}),Object.defineProperty(f,"masterKey",{get:function(){return s.default.get("MASTER_KEY")},set:function(e){s.default.set("MASTER_KEY",e)}}),Object.defineProperty(f,"serverURL",{get:function(){return s.default.get("SERVER_URL")},set:function(e){s.default.set("SERVER_URL",e)}}),Object.defineProperty(f,"liveQueryServerURL",{get:function(){return s.default.get("LIVEQUERY_SERVER_URL")},set:function(e){s.default.set("LIVEQUERY_SERVER_URL",e)}}),f.ACL=e("./ParseACL").default,f.Analytics=e("./Analytics"),f.Cloud=e("./Cloud"),f.CoreManager=e("./CoreManager"),f.Config=e("./ParseConfig").default,f.Error=e("./ParseError").default,f.FacebookUtils=e("./FacebookUtils").default,f.File=e("./ParseFile").default,f.GeoPoint=e("./ParseGeoPoint").default,f.Polygon=e("./ParsePolygon").default,f.Installation=e("./ParseInstallation").default,f.LocalDatastore=e("./LocalDatastore"),f.Object=e("./ParseObject").default,f.Op={Set:l.SetOp,Unset:l.UnsetOp,Increment:l.IncrementOp,Add:l.AddOp,Remove:l.RemoveOp,AddUnique:l.AddUniqueOp,Relation:l.RelationOp},f.Push=e("./Push"),f.Query=e("./ParseQuery").default,f.Relation=e("./ParseRelation").default,f.Role=e("./ParseRole").default,f.Schema=e("./ParseSchema").default,f.Session=e("./ParseSession").default,f.Storage=e("./Storage"),f.User=e("./ParseUser").default,f.LiveQuery=e("./ParseLiveQuery").default,f.LiveQueryClient=e("./LiveQueryClient").default,f._request=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.default.getRESTController().request.apply(null,t)},f._ajax=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return s.default.getRESTController().ajax.apply(null,t)},f._decode=function(e,t){return(0,i.default)(t)},f._encode=function(e,t,r){return(0,o.default)(e,r)},f._getInstallationId=function(){return s.default.getInstallationController().currentInstallationId()},f.enableLocalDatastore=function(){f.LocalDatastore.isEnabled=!0},f.isLocalDatastoreEnabled=function(){return f.LocalDatastore.isEnabled},f.dumpLocalDatastore=function(){return f.LocalDatastore.isEnabled?f.LocalDatastore._getAllContents():(console.log("Parse.enableLocalDatastore() must be called first"),Promise.resolve({}))},s.default.setInstallationController(u.default),s.default.setRESTController(c.default),f.Parse=f,t.exports=f},{"./Analytics":1,"./Cloud":2,"./CoreManager":3,"./FacebookUtils":5,"./InstallationController":6,"./LiveQueryClient":7,"./LocalDatastore":9,"./ParseACL":14,"./ParseConfig":15,"./ParseError":16,"./ParseFile":17,"./ParseGeoPoint":18,"./ParseInstallation":19,"./ParseLiveQuery":20,"./ParseObject":21,"./ParseOp":22,"./ParsePolygon":23,"./ParseQuery":24,"./ParseRelation":25,"./ParseRole":26,"./ParseSchema":27,"./ParseSession":28,"./ParseUser":29,"./Push":30,"./RESTController":31,"./Storage":33,"./decode":39,"./encode":40,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/interopRequireWildcard":59}],14:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=n(e("@babel/runtime/helpers/typeof")),s=n(e("@babel/runtime/helpers/classCallCheck")),a=n(e("@babel/runtime/helpers/createClass")),u=n(e("@babel/runtime/helpers/defineProperty")),l=n(e("./ParseRole")),c=n(e("./ParseUser")),i=function(){function i(e){if((0,s.default)(this,i),(0,u.default)(this,"permissionsById",void 0),this.permissionsById={},e&&"object"===(0,o.default)(e))if(e instanceof c.default)this.setReadAccess(e,!0),this.setWriteAccess(e,!0);else for(var t in e){var r=e[t];if("string"!=typeof t)throw new TypeError("Tried to create an ACL with an invalid user id.");for(var n in this.permissionsById[t]={},r){var a=r[n];if("read"!==n&&"write"!==n)throw new TypeError("Tried to create an ACL with an invalid permission type.");if("boolean"!=typeof a)throw new TypeError("Tried to create an ACL with an invalid permission value.");this.permissionsById[t][n]=a}}else if("function"==typeof e)throw new TypeError("ParseACL constructed with a function. Did you forget ()?")}return(0,a.default)(i,[{key:"toJSON",value:function(){var e={};for(var t in this.permissionsById)e[t]=this.permissionsById[t];return e}},{key:"equals",value:function(e){if(!(e instanceof i))return!1;var t=Object.keys(this.permissionsById),r=Object.keys(e.permissionsById);if(t.length!==r.length)return!1;for(var n in this.permissionsById){if(!e.permissionsById[n])return!1;if(this.permissionsById[n].read!==e.permissionsById[n].read)return!1;if(this.permissionsById[n].write!==e.permissionsById[n].write)return!1}return!0}},{key:"_setAccess",value:function(e,t,r){if(t instanceof c.default)t=t.id;else if(t instanceof l.default){var n=t.getName();if(!n)throw new TypeError("Role must have a name");t="role:"+n}if("string"!=typeof t)throw new TypeError("userId must be a string.");if("boolean"!=typeof r)throw new TypeError("allowed must be either true or false.");var a=this.permissionsById[t];if(!a){if(!r)return;a={},this.permissionsById[t]=a}r?this.permissionsById[t][e]=!0:(delete a[e],0===Object.keys(a).length&&delete this.permissionsById[t])}},{key:"_getAccess",value:function(e,t){if(t instanceof c.default){if(!(t=t.id))throw new Error("Cannot get access for a ParseUser without an ID")}else if(t instanceof l.default){var r=t.getName();if(!r)throw new TypeError("Role must have a name");t="role:"+r}var n=this.permissionsById[t];return!!n&&!!n[e]}},{key:"setReadAccess",value:function(e,t){this._setAccess("read",e,t)}},{key:"getReadAccess",value:function(e){return this._getAccess("read",e)}},{key:"setWriteAccess",value:function(e,t){this._setAccess("write",e,t)}},{key:"getWriteAccess",value:function(e){return this._getAccess("write",e)}},{key:"setPublicReadAccess",value:function(e){this.setReadAccess("*",e)}},{key:"getPublicReadAccess",value:function(){return this.getReadAccess("*")}},{key:"setPublicWriteAccess",value:function(e){this.setWriteAccess("*",e)}},{key:"getPublicWriteAccess",value:function(){return this.getWriteAccess("*")}},{key:"getRoleReadAccess",value:function(e){if(e instanceof l.default&&(e=e.getName()),"string"!=typeof e)throw new TypeError("role must be a ParseRole or a String");return this.getReadAccess("role:"+e)}},{key:"getRoleWriteAccess",value:function(e){if(e instanceof l.default&&(e=e.getName()),"string"!=typeof e)throw new TypeError("role must be a ParseRole or a String");return this.getWriteAccess("role:"+e)}},{key:"setRoleReadAccess",value:function(e,t){if(e instanceof l.default&&(e=e.getName()),"string"!=typeof e)throw new TypeError("role must be a ParseRole or a String");this.setReadAccess("role:"+e,t)}},{key:"setRoleWriteAccess",value:function(e,t){if(e instanceof l.default&&(e=e.getName()),"string"!=typeof e)throw new TypeError("role must be a ParseRole or a String");this.setWriteAccess("role:"+e,t)}}]),i}();r.default=i},{"./ParseRole":26,"./ParseUser":29,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],15:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/typeof")),i=n(e("@babel/runtime/helpers/classCallCheck")),o=n(e("@babel/runtime/helpers/createClass")),s=n(e("@babel/runtime/helpers/defineProperty")),u=n(e("./CoreManager")),l=n(e("./decode")),c=n(e("./encode")),f=n(e("./escape")),d=n(e("./ParseError")),h=n(e("./Storage")),p=function(){function e(){(0,i.default)(this,e),(0,s.default)(this,"attributes",void 0),(0,s.default)(this,"_escapedAttributes",void 0),this.attributes={},this._escapedAttributes={}}return(0,o.default)(e,[{key:"get",value:function(e){return this.attributes[e]}},{key:"escape",value:function(e){var t=this._escapedAttributes[e];if(t)return t;var r=this.attributes[e],n="";return null!=r&&(n=(0,f.default)(r.toString())),this._escapedAttributes[e]=n}}],[{key:"current",value:function(){return u.default.getConfigController().current()}},{key:"get",value:function(){return u.default.getConfigController().get()}},{key:"save",value:function(e){var t=u.default.getConfigController();return t.save(e).then(function(){return t.get()},function(e){return Promise.reject(e)})}}]),e}(),v=null,y="currentConfig";function b(e){try{var t=JSON.parse(e);if(t&&"object"===(0,a.default)(t))return(0,l.default)(t)}catch(e){return null}}var m={current:function(){if(v)return v;var e,r=new p,t=h.default.generatePath(y);if(h.default.async())return h.default.getItemAsync(t).then(function(e){if(e){var t=b(e);t&&(r.attributes=t,v=r)}return r});if(e=h.default.getItem(t)){var n=b(e);n&&(r.attributes=n,v=r)}return r},get:function(){return u.default.getRESTController().request("GET","config",{},{}).then(function(e){if(!e||!e.params){var t=new d.default(d.default.INVALID_JSON,"Config JSON response invalid.");return Promise.reject(t)}var r=new p;for(var n in r.attributes={},e.params)r.attributes[n]=(0,l.default)(e.params[n]);return v=r,h.default.setItemAsync(h.default.generatePath(y),JSON.stringify(e.params)).then(function(){return r})})},save:function(e){var t=u.default.getRESTController(),r={};for(var n in e)r[n]=(0,c.default)(e[n]);return t.request("PUT","config",{params:r},{useMasterKey:!0}).then(function(e){if(e&&e.result)return Promise.resolve();var t=new d.default(d.default.INTERNAL_SERVER_ERROR,"Error occured updating Config.");return Promise.reject(t)})}};u.default.setConfigController(m);var g=p;r.default=g},{"./CoreManager":3,"./ParseError":16,"./Storage":33,"./decode":39,"./encode":40,"./escape":42,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],16:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/createClass")),o=n(e("@babel/runtime/helpers/possibleConstructorReturn")),s=n(e("@babel/runtime/helpers/getPrototypeOf")),u=n(e("@babel/runtime/helpers/inherits")),l=n(e("@babel/runtime/helpers/assertThisInitialized")),c=function(e){function n(e,t){var r;return(0,a.default)(this,n),(r=(0,o.default)(this,(0,s.default)(n).call(this,t))).code=e,Object.defineProperty((0,l.default)((0,l.default)(r)),"message",{enumerable:!0,value:t}),r}return(0,u.default)(n,e),(0,i.default)(n,[{key:"toString",value:function(){return"ParseError: "+this.code+" "+this.message}}]),n}((0,n(e("@babel/runtime/helpers/wrapNativeSuper")).default)(Error));c.OTHER_CAUSE=-1,c.INTERNAL_SERVER_ERROR=1,c.CONNECTION_FAILED=100,c.OBJECT_NOT_FOUND=101,c.INVALID_QUERY=102,c.INVALID_CLASS_NAME=103,c.MISSING_OBJECT_ID=104,c.INVALID_KEY_NAME=105,c.INVALID_POINTER=106,c.INVALID_JSON=107,c.COMMAND_UNAVAILABLE=108,c.NOT_INITIALIZED=109,c.INCORRECT_TYPE=111,c.INVALID_CHANNEL_NAME=112,c.PUSH_MISCONFIGURED=115,c.OBJECT_TOO_LARGE=116,c.OPERATION_FORBIDDEN=119,c.CACHE_MISS=120,c.INVALID_NESTED_KEY=121,c.INVALID_FILE_NAME=122,c.INVALID_ACL=123,c.TIMEOUT=124,c.INVALID_EMAIL_ADDRESS=125,c.MISSING_CONTENT_TYPE=126,c.MISSING_CONTENT_LENGTH=127,c.INVALID_CONTENT_LENGTH=128,c.FILE_TOO_LARGE=129,c.FILE_SAVE_ERROR=130,c.DUPLICATE_VALUE=137,c.INVALID_ROLE_NAME=139,c.EXCEEDED_QUOTA=140,c.SCRIPT_FAILED=141,c.VALIDATION_ERROR=142,c.INVALID_IMAGE_DATA=143,c.UNSAVED_FILE_ERROR=151,c.INVALID_PUSH_TIME_ERROR=152,c.FILE_DELETE_ERROR=153,c.REQUEST_LIMIT_EXCEEDED=155,c.INVALID_EVENT_NAME=160,c.USERNAME_MISSING=200,c.PASSWORD_MISSING=201,c.USERNAME_TAKEN=202,c.EMAIL_TAKEN=203,c.EMAIL_MISSING=204,c.EMAIL_NOT_FOUND=205,c.SESSION_MISSING=206,c.MUST_CREATE_USER_THROUGH_SIGNUP=207,c.ACCOUNT_ALREADY_LINKED=208,c.INVALID_SESSION_TOKEN=209,c.LINKED_ID_MISSING=250,c.INVALID_LINKED_SESSION=251,c.UNSUPPORTED_SERVICE=252,c.INVALID_SCHEMA_OPERATION=255,c.AGGREGATE_ERROR=600,c.FILE_READ_ERROR=601,c.X_DOMAIN_REQUEST=602;var f=c;r.default=f},{"@babel/runtime/helpers/assertThisInitialized":49,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/getPrototypeOf":56,"@babel/runtime/helpers/inherits":57,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/possibleConstructorReturn":63,"@babel/runtime/helpers/wrapNativeSuper":68}],17:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var u=n(e("@babel/runtime/helpers/classCallCheck")),a=n(e("@babel/runtime/helpers/createClass")),l=n(e("@babel/runtime/helpers/defineProperty")),o=n(e("./CoreManager")),c=/^data:([a-zA-Z]+\/[-a-zA-Z0-9+.]+)(;charset=[a-zA-Z0-9\-\/]*)?;base64,/;function f(e){if(e<26)return String.fromCharCode(65+e);if(e<52)return String.fromCharCode(e-26+97);if(e<62)return String.fromCharCode(e-52+48);if(62===e)return"+";if(63===e)return"/";throw new TypeError("Tried to encode large digit "+e+" in base64.")}var i=function(){function s(e,t,r){(0,u.default)(this,s),(0,l.default)(this,"_name",void 0),(0,l.default)(this,"_url",void 0),(0,l.default)(this,"_source",void 0),(0,l.default)(this,"_previousSave",void 0);var n=r||"";if(this._name=e,void 0!==t)if(Array.isArray(t))this._source={format:"base64",base64:s.encodeBase64(t),type:n};else if("undefined"!=typeof File&&t instanceof File)this._source={format:"file",file:t,type:n};else{if(!t||"string"!=typeof t.base64)throw new TypeError("Cannot create a Parse.File with that data.");var a=t.base64,i=a.indexOf(",");if(-1!==i){var o=c.exec(a.slice(0,i+1));this._source={format:"base64",base64:a.slice(i+1),type:o[1]}}else this._source={format:"base64",base64:a,type:n}}}return(0,a.default)(s,[{key:"name",value:function(){return this._name}},{key:"url",value:function(e){if(e=e||{},this._url)return e.forceSecure?this._url.replace(/^http:\/\//i,"https://"):this._url}},{key:"save",value:function(e){var t=this;e=e||{};var r=o.default.getFileController();if(this._previousSave||("file"===this._source.format?this._previousSave=r.saveFile(this._name,this._source,e).then(function(e){return t._name=e.name,t._url=e.url,t}):this._previousSave=r.saveBase64(this._name,this._source,e).then(function(e){return t._name=e.name,t._url=e.url,t})),this._previousSave)return this._previousSave}},{key:"toJSON",value:function(){return{__type:"File",name:this._name,url:this._url}}},{key:"equals",value:function(e){return this===e||e instanceof s&&this.name()===e.name()&&this.url()===e.url()&&void 0!==this.url()}}],[{key:"fromJSON",value:function(e){if("File"!==e.__type)throw new TypeError("JSON object does not represent a ParseFile");var t=new s(e.name);return t._url=e.url,t}},{key:"encodeBase64",value:function(e){var t=[];t.length=Math.ceil(e.length/3);for(var r=0;r<t.length;r++){var n=e[3*r],a=e[3*r+1]||0,i=e[3*r+2]||0,o=3*r+1<e.length,s=3*r+2<e.length;t[r]=[f(n>>2&63),f(n<<4&48|a>>4&15),o?f(a<<2&60|i>>6&3):"=",s?f(63&i):"="].join("")}return t.join("")}}]),s}(),s={saveFile:function(e,t,r){if("file"!==t.format)throw new Error("saveFile can only be used with File-type sources.");var n={"X-Parse-Application-ID":o.default.get("APPLICATION_ID"),"Content-Type":t.type||(t.file?t.file.type:null)},a=o.default.get("JAVASCRIPT_KEY");a&&(n["X-Parse-JavaScript-Key"]=a);var i=o.default.get("SERVER_URL");return"/"!==i[i.length-1]&&(i+="/"),i+="files/"+e,o.default.getRESTController().ajax("POST",i,t.file,n,r).then(function(e){return e.response})},saveBase64:function(e,t,r){if("base64"!==t.format)throw new Error("saveBase64 can only be used with Base64-type sources.");var n={base64:t.base64};return t.type&&(n._ContentType=t.type),o.default.getRESTController().request("POST","files/"+e,n,r)}};o.default.setFileController(s);var d=i;r.default=d},{"./CoreManager":3,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/interopRequireDefault":58}],18:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/typeof")),i=n(e("@babel/runtime/helpers/classCallCheck")),o=n(e("@babel/runtime/helpers/createClass")),s=n(e("@babel/runtime/helpers/defineProperty")),u=function(){function r(e,t){(0,i.default)(this,r),(0,s.default)(this,"_latitude",void 0),(0,s.default)(this,"_longitude",void 0),Array.isArray(e)?(r._validate(e[0],e[1]),this._latitude=e[0],this._longitude=e[1]):"object"===(0,a.default)(e)?(r._validate(e.latitude,e.longitude),this._latitude=e.latitude,this._longitude=e.longitude):this._longitude=void 0!==e&&void 0!==t?(r._validate(e,t),this._latitude=e,t):this._latitude=0}return(0,o.default)(r,[{key:"toJSON",value:function(){return r._validate(this._latitude,this._longitude),{__type:"GeoPoint",latitude:this._latitude,longitude:this._longitude}}},{key:"equals",value:function(e){return e instanceof r&&this.latitude===e.latitude&&this.longitude===e.longitude}},{key:"radiansTo",value:function(e){var t=Math.PI/180,r=this.latitude*t,n=this.longitude*t,a=e.latitude*t,i=e.longitude*t,o=Math.sin((r-a)/2),s=Math.sin((n-i)/2),u=o*o+Math.cos(r)*Math.cos(a)*s*s;return u=Math.min(1,u),2*Math.asin(Math.sqrt(u))}},{key:"kilometersTo",value:function(e){return 6371*this.radiansTo(e)}},{key:"milesTo",value:function(e){return 3958.8*this.radiansTo(e)}},{key:"latitude",get:function(){return this._latitude},set:function(e){r._validate(e,this.longitude),this._latitude=e}},{key:"longitude",get:function(){return this._longitude},set:function(e){r._validate(this.latitude,e),this._longitude=e}}],[{key:"_validate",value:function(e,t){if(isNaN(e)||isNaN(t)||"number"!=typeof e||"number"!=typeof t)throw new TypeError("GeoPoint latitude and longitude must be valid numbers");if(e<-90)throw new TypeError("GeoPoint latitude out of bounds: "+e+" < -90.0.");if(90<e)throw new TypeError("GeoPoint latitude out of bounds: "+e+" > 90.0.");if(t<-180)throw new TypeError("GeoPoint longitude out of bounds: "+t+" < -180.0.");if(180<t)throw new TypeError("GeoPoint longitude out of bounds: "+t+" > 180.0.")}},{key:"current",value:function(){return navigator.geolocation.getCurrentPosition(function(e){return new r(e.coords.latitude,e.coords.longitude)})}}]),r}();r.default=u},{"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],19:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/typeof")),i=n(e("@babel/runtime/helpers/classCallCheck")),o=n(e("@babel/runtime/helpers/possibleConstructorReturn")),s=n(e("@babel/runtime/helpers/getPrototypeOf")),u=n(e("@babel/runtime/helpers/inherits")),l=n(e("./ParseObject")),c=function(e){function r(e){var t;if((0,i.default)(this,r),t=(0,o.default)(this,(0,s.default)(r).call(this,"_Installation")),e&&"object"===(0,a.default)(e)&&!t.set(e||{}))throw new Error("Can't create an invalid Session");return t}return(0,u.default)(r,e),r}(l.default);r.default=c,l.default.registerSubclass("_Installation",c)},{"./ParseObject":21,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/getPrototypeOf":56,"@babel/runtime/helpers/inherits":57,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/possibleConstructorReturn":63,"@babel/runtime/helpers/typeof":67}],20:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("./EventEmitter")),s=n(e("./LiveQueryClient")),u=n(e("./CoreManager"));var l=new i.default;l.open=function(){u.default.getLiveQueryController().open()},l.close=function(){u.default.getLiveQueryController().close()},l.on("error",function(){});var c,a=l;function o(){return u.default.getUserController().currentUserAsync().then(function(e){return e?e.getSessionToken():void 0})}function f(){return u.default.getLiveQueryController().getDefaultLiveQueryClient()}r.default=a;var d={setDefaultLiveQueryClient:function(e){c=e},getDefaultLiveQueryClient:function(){return c?Promise.resolve(c):o().then(function(e){var t=u.default.get("LIVEQUERY_SERVER_URL");if(t&&0!==t.indexOf("ws"))throw new Error("You need to set a proper Parse LiveQuery server url before using LiveQueryClient");if(!t){var r=u.default.get("SERVER_URL"),n="ws://";0===r.indexOf("https")&&(n="wss://"),t=n+r.replace(/^https?:\/\//,""),u.default.set("LIVEQUERY_SERVER_URL",t)}var a=u.default.get("APPLICATION_ID"),i=u.default.get("JAVASCRIPT_KEY"),o=u.default.get("MASTER_KEY");return(c=new s.default({applicationId:a,serverURL:t,javascriptKey:i,masterKey:o,sessionToken:e})).on("error",function(e){l.emit("error",e)}),c.on("open",function(){l.emit("open")}),c.on("close",function(){l.emit("close")}),c})},open:function(){f().then(function(e){return e.open()})},close:function(){f().then(function(e){return e.close()})},subscribe:function(n){var a=new i.default;return f().then(function(r){return r.shouldOpen()&&r.open(),o().then(function(e){var t=r.subscribe(n,e);a.id=t.id,a.query=t.query,a.sessionToken=t.sessionToken,a.unsubscribe=t.unsubscribe,t.on("open",function(){a.emit("open")}),t.on("create",function(e){a.emit("create",e)}),t.on("update",function(e){a.emit("update",e)}),t.on("enter",function(e){a.emit("enter",e)}),t.on("leave",function(e){a.emit("leave",e)}),t.on("delete",function(e){a.emit("delete",e)}),t.on("close",function(e){a.emit("close",e)}),t.on("error",function(e){a.emit("error",e)})})}),a},unsubscribe:function(t){f().then(function(e){return e.unsubscribe(t)})},_clearCachedDefaultClient:function(){c=null}};u.default.setLiveQueryController(d)},{"./CoreManager":3,"./EventEmitter":4,"./LiveQueryClient":7,"@babel/runtime/helpers/interopRequireDefault":58}],21:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireWildcard"),a=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var v=a(e("@babel/runtime/regenerator")),y=a(e("@babel/runtime/helpers/asyncToGenerator")),m=a(e("@babel/runtime/helpers/typeof")),i=a(e("@babel/runtime/helpers/classCallCheck")),o=a(e("@babel/runtime/helpers/createClass")),s=a(e("@babel/runtime/helpers/defineProperty")),g=a(e("./CoreManager")),b=a(e("./canBeSerialized")),l=a(e("./decode")),c=a(e("./encode")),f=a(e("./escape")),_=a(e("./ParseACL")),d=a(e("./parseDate")),w=a(e("./ParseError")),P=a(e("./ParseFile")),O=e("./promiseUtils"),k=e("./ParseOp"),u=a(e("./ParseQuery")),C=a(e("./ParseRelation")),h=n(e("./SingleInstanceStateController")),S=a(e("./unique")),p=n(e("./UniqueInstanceStateController")),E=a(e("./unsavedChildren")),A={},N=0,I=0,R=!g.default.get("IS_NODE");function T(){var e=g.default.get("SERVER_URL");"/"!==e[e.length-1]&&(e+="/");var t=e.replace(/https?:\/\//,"");return t.substr(t.indexOf("/"))}R?g.default.setObjectStateController(h):g.default.setObjectStateController(p);var j,x=function(){function u(e,t,r){(0,i.default)(this,u),(0,s.default)(this,"id",void 0),(0,s.default)(this,"_localId",void 0),(0,s.default)(this,"_objCount",void 0),(0,s.default)(this,"className",void 0),"function"==typeof this.initialize&&this.initialize.apply(this,arguments);var n=null;if(this._objCount=I++,"string"==typeof e)this.className=e,t&&"object"===(0,m.default)(t)&&(n=t);else if(e&&"object"===(0,m.default)(e)){for(var a in this.className=e.className,n={},e)"className"!==a&&(n[a]=e[a]);t&&"object"===(0,m.default)(t)&&(r=t)}if(n&&!this.set(n,r))throw new Error("Can't create an invalid Parse Object")}var e,t,r,n;return(0,o.default)(u,[{key:"_getId",value:function(){if("string"==typeof this.id)return this.id;if("string"==typeof this._localId)return this._localId;var e="local"+String(N++);return this._localId=e}},{key:"_getStateIdentifier",value:function(){if(R){var e=this.id;return e||(e=this._getId()),{id:e,className:this.className}}return this}},{key:"_getServerData",value:function(){return g.default.getObjectStateController().getServerData(this._getStateIdentifier())}},{key:"_clearServerData",value:function(){var e=this._getServerData(),t={};for(var r in e)t[r]=void 0;g.default.getObjectStateController().setServerData(this._getStateIdentifier(),t)}},{key:"_getPendingOps",value:function(){return g.default.getObjectStateController().getPendingOps(this._getStateIdentifier())}},{key:"_clearPendingOps",value:function(e){var t=this._getPendingOps(),r=t[t.length-1];(e||Object.keys(r)).forEach(function(e){delete r[e]})}},{key:"_getDirtyObjectAttributes",value:function(){var e=this.attributes,t=g.default.getObjectStateController().getObjectCache(this._getStateIdentifier()),r={};for(var n in e){var a=e[n];if(a&&"object"===(0,m.default)(a)&&!(a instanceof u)&&!(a instanceof P.default)&&!(a instanceof C.default))try{var i=(0,c.default)(a,!1,!0),o=JSON.stringify(i);t[n]!==o&&(r[n]=a)}catch(e){r[n]=a}}return r}},{key:"_toFullJSON",value:function(e){var t=this.toJSON(e);return t.__type="Object",t.className=this.className,t}},{key:"_getSaveJSON",value:function(){var e=this._getPendingOps(),t=this._getDirtyObjectAttributes(),r={};for(var n in t){for(var a=!1,i=0;i<e.length;i+=1)for(var o in e[i]){if(o.includes("."))if(o.split(".")[0]===n){a=!0;break}}a||(r[n]=new k.SetOp(t[n]).toJSON())}for(n in e[0])r[n]=e[0][n].toJSON();return r}},{key:"_getSaveParams",value:function(){var e=this.id?"PUT":"POST",t=this._getSaveJSON(),r="classes/"+this.className;return this.id?r+="/"+this.id:"_User"===this.className&&(r="users"),{method:e,body:t,path:r}}},{key:"_finishFetch",value:function(e){!this.id&&e.objectId&&(this.id=e.objectId);var t=g.default.getObjectStateController();t.initializeState(this._getStateIdentifier());var r={};for(var n in e)"ACL"===n?r[n]=new _.default(e[n]):"objectId"!==n&&(r[n]=(0,l.default)(e[n]),r[n]instanceof C.default&&r[n]._ensureParentAndKey(this,n));r.createdAt&&"string"==typeof r.createdAt&&(r.createdAt=(0,d.default)(r.createdAt)),r.updatedAt&&"string"==typeof r.updatedAt&&(r.updatedAt=(0,d.default)(r.updatedAt)),!r.updatedAt&&r.createdAt&&(r.updatedAt=r.createdAt),t.commitServerChanges(this._getStateIdentifier(),r)}},{key:"_setExisted",value:function(e){var t=g.default.getObjectStateController().getState(this._getStateIdentifier());t&&(t.existed=e)}},{key:"_migrateId",value:function(e){if(this._localId&&e)if(R){var t=g.default.getObjectStateController(),r=t.removeState(this._getStateIdentifier());this.id=e,delete this._localId,r&&t.initializeState(this._getStateIdentifier(),r)}else this.id=e,delete this._localId}},{key:"_handleSaveResponse",value:function(e,t){var r={},n=g.default.getObjectStateController(),a=n.popPendingState(this._getStateIdentifier());for(var i in a)a[i]instanceof k.RelationOp?r[i]=a[i].applyTo(void 0,this,i):i in e||(r[i]=a[i].applyTo(void 0));for(i in e)"createdAt"!==i&&"updatedAt"!==i||"string"!=typeof e[i]?"ACL"===i?r[i]=new _.default(e[i]):"objectId"!==i&&(r[i]=(0,l.default)(e[i]),r[i]instanceof k.UnsetOp&&(r[i]=void 0)):r[i]=(0,d.default)(e[i]);r.createdAt&&!r.updatedAt&&(r.updatedAt=r.createdAt),this._migrateId(e.objectId),201!==t&&this._setExisted(!0),n.commitServerChanges(this._getStateIdentifier(),r)}},{key:"_handleSaveError",value:function(){g.default.getObjectStateController().mergeFirstPendingState(this._getStateIdentifier())}},{key:"initialize",value:function(){}},{key:"toJSON",value:function(e){var t=this.id?this.className+":"+this.id:this;e=e||[t];var r={},n=this.attributes;for(var a in n)"createdAt"!==a&&"updatedAt"!==a||!n[a].toJSON?r[a]=(0,c.default)(n[a],!1,!1,e):r[a]=n[a].toJSON();var i=this._getPendingOps();for(var o in i[0])r[o]=i[0][o].toJSON();return this.id&&(r.objectId=this.id),r}},{key:"equals",value:function(e){return this===e||e instanceof u&&this.className===e.className&&this.id===e.id&&void 0!==this.id}},{key:"dirty",value:function(e){if(!this.id)return!0;var t=this._getPendingOps(),r=this._getDirtyObjectAttributes();if(e){if(r.hasOwnProperty(e))return!0;for(var n=0;n<t.length;n++)if(t[n].hasOwnProperty(e))return!0;return!1}return 0!==Object.keys(t[0]).length||0!==Object.keys(r).length}},{key:"dirtyKeys",value:function(){for(var e=this._getPendingOps(),t={},r=0;r<e.length;r++)for(var n in e[r])t[n]=!0;var a=this._getDirtyObjectAttributes();for(var i in a)t[i]=!0;return Object.keys(t)}},{key:"toPointer",value:function(){if(!this.id)throw new Error("Cannot create a pointer to an unsaved ParseObject");return{__type:"Pointer",className:this.className,objectId:this.id}}},{key:"get",value:function(e){return this.attributes[e]}},{key:"relation",value:function(e){var t=this.get(e);if(t){if(!(t instanceof C.default))throw new Error("Called relation() on non-relation field "+e);return t._ensureParentAndKey(this,e),t}return new C.default(this,e)}},{key:"escape",value:function(e){var t=this.attributes[e];if(null==t)return"";if("string"!=typeof t){if("function"!=typeof t.toString)return"";t=t.toString()}return(0,f.default)(t)}},{key:"has",value:function(e){var t=this.attributes;return!!t.hasOwnProperty(e)&&null!=t[e]}},{key:"set",value:function(e,t,r){var n={},a={};if(e&&"object"===(0,m.default)(e))n=e,r=t;else{if("string"!=typeof e)return this;n[e]=t}r=r||{};var i=[];for(var o in"function"==typeof this.constructor.readOnlyAttributes&&(i=i.concat(this.constructor.readOnlyAttributes())),n)if("createdAt"!==o&&"updatedAt"!==o){if(-1<i.indexOf(o))throw new Error("Cannot modify readonly attribute: "+o);if(r.unset)a[o]=new k.UnsetOp;else if(n[o]instanceof k.Op)a[o]=n[o];else if(n[o]&&"object"===(0,m.default)(n[o])&&"string"==typeof n[o].__op)a[o]=(0,k.opFromJSON)(n[o]);else if("objectId"===o||"id"===o)"string"==typeof n[o]&&(this.id=n[o]);else if("ACL"!==o||"object"!==(0,m.default)(n[o])||n[o]instanceof _.default)if(n[o]instanceof C.default){var s=new C.default(this,o);s.targetClassName=n[o].targetClassName,a[o]=new k.SetOp(s)}else a[o]=new k.SetOp(n[o]);else a[o]=new k.SetOp(new _.default(n[o]))}var u=this.attributes,l=this._getServerData();if("string"==typeof e&&e.includes(".")&&!l[e.split(".")[0]])return this;var c={};for(var f in a)a[f]instanceof k.RelationOp?c[f]=a[f].applyTo(u[f],this,f):a[f]instanceof k.UnsetOp||(c[f]=a[f].applyTo(u[f]));if(!r.ignoreValidation){var d=this.validate(c);if(d)return"function"==typeof r.error&&r.error(this,d),!1}var h=this._getPendingOps(),p=h.length-1,v=g.default.getObjectStateController();for(var y in a){var b=a[y].mergeWith(h[p][y]);v.setPendingOp(this._getStateIdentifier(),y,b)}return this}},{key:"unset",value:function(e,t){return(t=t||{}).unset=!0,this.set(e,null,t)}},{key:"increment",value:function(e,t){if(void 0===t&&(t=1),"number"!=typeof t)throw new Error("Cannot increment by a non-numeric amount.");return this.set(e,new k.IncrementOp(t))}},{key:"add",value:function(e,t){return this.set(e,new k.AddOp([t]))}},{key:"addAll",value:function(e,t){return this.set(e,new k.AddOp(t))}},{key:"addUnique",value:function(e,t){return this.set(e,new k.AddUniqueOp([t]))}},{key:"addAllUnique",value:function(e,t){return this.set(e,new k.AddUniqueOp(t))}},{key:"remove",value:function(e,t){return this.set(e,new k.RemoveOp([t]))}},{key:"removeAll",value:function(e,t){return this.set(e,new k.RemoveOp(t))}},{key:"op",value:function(e){for(var t=this._getPendingOps(),r=t.length;r--;)if(t[r][e])return t[r][e]}},{key:"clone",value:function(){var e=new this.constructor;e.className||(e.className=this.className);var t=this.attributes;if("function"==typeof this.constructor.readOnlyAttributes){var r=this.constructor.readOnlyAttributes()||[],n={};for(var a in t)r.indexOf(a)<0&&(n[a]=t[a]);t=n}return e.set&&e.set(t),e}},{key:"newInstance",value:function(){var e=new this.constructor;if(e.className||(e.className=this.className),e.id=this.id,R)return e;var t=g.default.getObjectStateController();return t&&t.duplicateState(this._getStateIdentifier(),e._getStateIdentifier()),e}},{key:"isNew",value:function(){return!this.id}},{key:"existed",value:function(){if(!this.id)return!1;var e=g.default.getObjectStateController().getState(this._getStateIdentifier());return!!e&&e.existed}},{key:"isValid",value:function(){return!this.validate(this.attributes)}},{key:"validate",value:function(e){if(e.hasOwnProperty("ACL")&&!(e.ACL instanceof _.default))return new w.default(w.default.OTHER_CAUSE,"ACL must be a Parse ACL.");for(var t in e)if(!/^[A-Za-z][0-9A-Za-z_.]*$/.test(t))return new w.default(w.default.INVALID_KEY_NAME);return!1}},{key:"getACL",value:function(){var e=this.get("ACL");return e instanceof _.default?e:null}},{key:"setACL",value:function(e,t){return this.set("ACL",e,t)}},{key:"revert",value:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length){e=[];for(var a=0;a<r.length;a++){var i=r[a];if("string"!=typeof i)throw new Error("Parse.Object#revert expects either no, or a list of string, arguments.");e.push(i)}}this._clearPendingOps(e)}},{key:"clear",value:function(){var e=this.attributes,t={},r=["createdAt","updatedAt"];for(var n in"function"==typeof this.constructor.readOnlyAttributes&&(r=r.concat(this.constructor.readOnlyAttributes())),e)r.indexOf(n)<0&&(t[n]=!0);return this.set(t,{unset:!0})}},{key:"fetch",value:function(e){var t={};return(e=e||{}).hasOwnProperty("useMasterKey")&&(t.useMasterKey=e.useMasterKey),e.hasOwnProperty("sessionToken")&&(t.sessionToken=e.sessionToken),e.hasOwnProperty("include")&&(t.include=[],Array.isArray(e.include)?e.include.forEach(function(e){Array.isArray(e)?t.include=t.include.concat(e):t.include.push(e)}):t.include.push(e.include)),g.default.getObjectController().fetch(this,!0,t)}},{key:"fetchWithInclude",value:function(e,t){return(t=t||{}).include=e,this.fetch(t)}},{key:"save",value:function(e,t,r){var n,a,i=this;if("object"===(0,m.default)(e)||void 0===e?(n=e,"object"===(0,m.default)(t)&&(a=t)):((n={})[e]=t,a=r),!a&&n&&(a={},"function"==typeof n.success&&(a.success=n.success,delete n.success),"function"==typeof n.error&&(a.error=n.error,delete n.error)),n){var o=this.validate(n);if(o)return a&&"function"==typeof a.error&&a.error(this,o),Promise.reject(o);this.set(n,a)}var s={};(a=a||{}).hasOwnProperty("useMasterKey")&&(s.useMasterKey=!!a.useMasterKey),a.hasOwnProperty("sessionToken")&&"string"==typeof a.sessionToken&&(s.sessionToken=a.sessionToken);var u=g.default.getObjectController(),l=(0,E.default)(this);return u.save(l,s).then(function(){return u.save(i,s)})}},{key:"destroy",value:function(e){var t={};return(e=e||{}).hasOwnProperty("useMasterKey")&&(t.useMasterKey=e.useMasterKey),e.hasOwnProperty("sessionToken")&&(t.sessionToken=e.sessionToken),this.id?g.default.getObjectController().destroy(this,t):Promise.resolve()}},{key:"pin",value:function(){var e=g.default.getLocalDatastore();return u.pinAllWithName(e.DEFAULT_PIN,[this])}},{key:"unPin",value:function(){var e=g.default.getLocalDatastore();return u.unPinAllWithName(e.DEFAULT_PIN,[this])}},{key:"isPinned",value:(n=(0,y.default)(v.default.mark(function e(){var t,r;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=g.default.getLocalDatastore()).checkIfEnabled())return r=t.getKeyForObject(this),e.next=5,t.fromPinWithName(r);e.next=8;break;case 5:if(e.sent)return e.abrupt("return",Promise.resolve(!0));e.next=8;break;case 8:return e.abrupt("return",Promise.resolve(!1));case 9:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"pinWithName",value:function(e){return u.pinAllWithName(e,[this])}},{key:"unPinWithName",value:function(e){return u.unPinAllWithName(e,[this])}},{key:"fetchFromLocalDatastore",value:(r=(0,y.default)(v.default.mark(function e(){var t,r,n,a;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=g.default.getLocalDatastore()).checkIfEnabled())return r=t.getKeyForObject(this),e.next=5,t._serializeObject(r);e.next=11;break;case 5:if(n=e.sent){e.next=8;break}throw new Error("Cannot fetch an unsaved ParseObject");case 8:return a=u.fromJSON(n),this._finishFetch(a.toJSON()),e.abrupt("return",Promise.resolve(this));case 11:case"end":return e.stop()}},e,this)})),function(){return r.apply(this,arguments)})},{key:"attributes",get:function(){var e=g.default.getObjectStateController();return Object.freeze(e.estimateAttributes(this._getStateIdentifier()))}},{key:"createdAt",get:function(){return this._getServerData().createdAt}},{key:"updatedAt",get:function(){return this._getServerData().updatedAt}}],[{key:"_clearAllState",value:function(){g.default.getObjectStateController().clearAllState()}},{key:"fetchAll",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r={};return t.hasOwnProperty("useMasterKey")&&(r.useMasterKey=t.useMasterKey),t.hasOwnProperty("sessionToken")&&(r.sessionToken=t.sessionToken),t.hasOwnProperty("include")&&(r.include=[],Array.isArray(t.include)?t.include.forEach(function(e){Array.isArray(e)?r.include=r.include.concat(e):r.include.push(e)}):r.include.push(t.include)),g.default.getObjectController().fetch(e,!0,r)}},{key:"fetchAllWithInclude",value:function(e,t,r){return(r=r||{}).include=t,u.fetchAll(e,r)}},{key:"fetchAllIfNeeded",value:function(e,t){var r={};return(t=t||{}).hasOwnProperty("useMasterKey")&&(r.useMasterKey=t.useMasterKey),t.hasOwnProperty("sessionToken")&&(r.sessionToken=t.sessionToken),g.default.getObjectController().fetch(e,!1,r)}},{key:"destroyAll",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r={};return t.hasOwnProperty("useMasterKey")&&(r.useMasterKey=t.useMasterKey),t.hasOwnProperty("sessionToken")&&(r.sessionToken=t.sessionToken),t.hasOwnProperty("batchSize")&&"number"==typeof t.batchSize&&(r.batchSize=t.batchSize),g.default.getObjectController().destroy(e,r)}},{key:"saveAll",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r={};return t.hasOwnProperty("useMasterKey")&&(r.useMasterKey=t.useMasterKey),t.hasOwnProperty("sessionToken")&&(r.sessionToken=t.sessionToken),t.hasOwnProperty("batchSize")&&"number"==typeof t.batchSize&&(r.batchSize=t.batchSize),g.default.getObjectController().save(e,r)}},{key:"createWithoutData",value:function(e){var t=new this;return t.id=e,t}},{key:"fromJSON",value:function(e,t){if(!e.className)throw new Error("Cannot create an object without a className");var r=A[e.className],n=r?new r:new u(e.className),a={};for(var i in e)"className"!==i&&"__type"!==i&&(a[i]=e[i]);if(t){a.objectId&&(n.id=a.objectId);var o=null;"function"==typeof n._preserveFieldsOnFetch&&(o=n._preserveFieldsOnFetch()),n._clearServerData(),o&&n._finishFetch(o)}return n._finishFetch(a),e.objectId&&n._setExisted(!0),n}},{key:"registerSubclass",value:function(e,t){if("string"!=typeof e)throw new TypeError("The first argument must be a valid class name.");if(void 0===t)throw new TypeError("You must supply a subclass constructor.");if("function"!=typeof t)throw new TypeError("You must register the subclass constructor. Did you attempt to register an instance of the subclass?");(A[e]=t).className||(t.className=e)}},{key:"extend",value:function(e,t,r){if("string"!=typeof e){if(e&&"string"==typeof e.className)return u.extend(e.className,e,t);throw new Error("Parse.Object.extend's first argument should be the className.")}var n=e;"User"===n&&g.default.get("PERFORM_USER_REWRITE")&&(n="_User");var a=u.prototype;this.hasOwnProperty("__super__")&&this.__super__?a=this.prototype:A[n]&&(a=A[n].prototype);var i=function(e,t){if(this.className=n,this._objCount=I++,"function"==typeof this.initialize&&this.initialize.apply(this,arguments),e&&"object"===(0,m.default)(e)&&!this.set(e||{},t))throw new Error("Can't create an invalid Parse Object")};if(i.className=n,i.__super__=a,i.prototype=Object.create(a,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),t)for(var o in t)"className"!==o&&Object.defineProperty(i.prototype,o,{value:t[o],enumerable:!1,writable:!0,configurable:!0});if(r)for(var s in r)"className"!==s&&Object.defineProperty(i,s,{value:r[s],enumerable:!1,writable:!0,configurable:!0});return i.extend=function(e,t,r){return"string"==typeof e?u.extend.call(i,e,t,r):u.extend.call(i,n,e,t)},i.createWithoutData=u.createWithoutData,A[n]=i}},{key:"enableSingleInstance",value:function(){R=!0,g.default.setObjectStateController(h)}},{key:"disableSingleInstance",value:function(){R=!1,g.default.setObjectStateController(p)}},{key:"pinAll",value:function(e){var t=g.default.getLocalDatastore();if(t.checkIfEnabled())return u.pinAllWithName(t.DEFAULT_PIN,e)}},{key:"pinAllWithName",value:(t=(0,y.default)(v.default.mark(function e(t,r){var n,a,i,o,s,u,l;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=g.default.getLocalDatastore()).checkIfEnabled()){e.next=28;break}i=!(a=!0),o=void 0,e.prev=5,s=r[Symbol.iterator]();case 7:if(a=(u=s.next()).done){e.next=14;break}return l=u.value,e.next=11,n._handlePinWithName(t,l);case 11:a=!0,e.next=7;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),i=!0,o=e.t0;case 20:e.prev=20,e.prev=21,a||null==s.return||s.return();case 23:if(e.prev=23,i)throw o;e.next=26;break;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}},e,this,[[5,16,20,28],[21,,23,27]])})),function(){return t.apply(this,arguments)})},{key:"unPinAll",value:function(e){var t=g.default.getLocalDatastore();if(t.checkIfEnabled())return u.unPinAllWithName(t.DEFAULT_PIN,e)}},{key:"unPinAllWithName",value:(e=(0,y.default)(v.default.mark(function e(t,r){var n,a,i,o,s,u,l;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=g.default.getLocalDatastore()).checkIfEnabled()){e.next=28;break}i=!(a=!0),o=void 0,e.prev=5,s=r[Symbol.iterator]();case 7:if(a=(u=s.next()).done){e.next=14;break}return l=u.value,e.next=11,n._handleUnPinWithName(t,l);case 11:a=!0,e.next=7;break;case 14:e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),i=!0,o=e.t0;case 20:e.prev=20,e.prev=21,a||null==s.return||s.return();case 23:if(e.prev=23,i)throw o;e.next=26;break;case 26:return e.finish(23);case 27:return e.finish(20);case 28:case"end":return e.stop()}},e,this,[[5,16,20,28],[21,,23,27]])})),function(){return e.apply(this,arguments)})},{key:"unPinAllObjects",value:function(){var e=g.default.getLocalDatastore();if(e.checkIfEnabled())return e.unPinWithName(e.DEFAULT_PIN)}},{key:"unPinAllObjectsWithName",value:function(e){var t=g.default.getLocalDatastore();if(t.checkIfEnabled())return t.unPinWithName(t.PIN_PREFIX+e)}}]),u}(),D={fetch:function(r,c,e){var f=g.default.getLocalDatastore();if(Array.isArray(r)){if(r.length<1)return Promise.resolve([]);var d=[],t=[],n=null,h=[],a=null;if(r.forEach(function(e){a||(n||(n=e.className),n!==e.className&&(a=new w.default(w.default.INVALID_CLASS_NAME,"All objects should be of the same class")),e.id||(a=new w.default(w.default.MISSING_OBJECT_ID,"All objects must have an ID")),(c||0===Object.keys(e._getServerData()).length)&&(t.push(e.id),d.push(e)),h.push(e))}),a)return Promise.reject(a);var i=new u.default(n);return i.containedIn("objectId",t),e&&e.include&&i.include(e.include),i._limit=t.length,i.find(e).then(function(){var e=(0,y.default)(v.default.mark(function e(t){var r,n,a,i,o,s,u,l;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r={},t.forEach(function(e){r[e.id]=e}),n=0;case 3:if(!(n<d.length)){e.next=11;break}if((a=d[n])&&a.id&&r[a.id]){e.next=8;break}if(c)return e.abrupt("return",Promise.reject(new w.default(w.default.OBJECT_NOT_FOUND,"All objects must exist on the server.")));e.next=8;break;case 8:n++,e.next=3;break;case 11:if(!R)for(i=0;i<h.length;i++)(o=h[i])&&o.id&&r[o.id]&&(s=o.id,o._finishFetch(r[s].toJSON()),h[i]=r[s]);u=0;case 13:if(u<h.length)return l=h[u],e.next=17,f._updateObjectIfPinned(l);e.next=20;break;case 17:u++,e.next=13;break;case 20:return e.abrupt("return",Promise.resolve(h));case 21:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}())}var o=g.default.getRESTController(),s={};return e&&e.include&&(s.include=e.include.join()),o.request("GET","classes/"+r.className+"/"+r._getId(),s,e).then(function(){var e=(0,y.default)(v.default.mark(function e(t){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r instanceof x&&(r._clearPendingOps(),r._clearServerData(),r._finishFetch(t)),e.next=3,f._updateObjectIfPinned(r);case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}())},destroy:(j=(0,y.default)(v.default.mark(function e(u,t){var r,l,a,n,i,c;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t&&t.batchSize?t.batchSize:20,l=g.default.getLocalDatastore(),a=g.default.getRESTController(),!Array.isArray(u)){e.next=15;break}if(u.length<1)return e.abrupt("return",Promise.resolve([]));e.next=6;break;case 6:return n=[[]],u.forEach(function(e){e.id&&(n[n.length-1].push(e),n[n.length-1].length>=r&&n.push([]))}),0===n[n.length-1].length&&n.pop(),i=Promise.resolve(),c=[],n.forEach(function(n){i=i.then(function(){return a.request("POST","batch",{requests:n.map(function(e){return{method:"DELETE",path:T()+"classes/"+e.className+"/"+e._getId(),body:{}}})},t).then(function(e){for(var t=0;t<e.length;t++)if(e[t]&&e[t].hasOwnProperty("error")){var r=new w.default(e[t].error.code,e[t].error.error);r.object=n[t],c.push(r)}})})}),e.abrupt("return",i.then((0,y.default)(v.default.mark(function e(){var t,r,n,a,i,o,s;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(c.length)return(t=new w.default(w.default.AGGREGATE_ERROR)).errors=c,e.abrupt("return",Promise.reject(t));e.next=4;break;case 4:n=!(r=!0),a=void 0,e.prev=7,i=u[Symbol.iterator]();case 9:if(r=(o=i.next()).done){e.next=16;break}return s=o.value,e.next=13,l._destroyObjectIfPinned(s);case 13:r=!0,e.next=9;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(7),n=!0,a=e.t0;case 22:e.prev=22,e.prev=23,r||null==i.return||i.return();case 25:if(e.prev=25,n)throw a;e.next=28;break;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",Promise.resolve(u));case 31:case"end":return e.stop()}},e,this,[[7,18,22,30],[23,,25,29]])}))));case 15:if(u instanceof x)return e.abrupt("return",a.request("DELETE","classes/"+u.className+"/"+u._getId(),{},t).then((0,y.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l._destroyObjectIfPinned(u);case 2:return e.abrupt("return",Promise.resolve(u));case 3:case"end":return e.stop()}},e,this)}))));e.next=17;break;case 17:return e.next=19,l._destroyObjectIfPinned(u);case 19:return e.abrupt("return",Promise.resolve(u));case 20:case"end":return e.stop()}},e,this)})),function(){return j.apply(this,arguments)}),save:function(s,i){var c=i&&i.batchSize?i.batchSize:20,u=g.default.getLocalDatastore(),f={},d=g.default.getRESTController(),h=g.default.getObjectStateController();if(Array.isArray(s)){if(s.length<1)return Promise.resolve([]);for(var e=s.concat(),t=0;t<s.length;t++)s[t]instanceof x&&(e=e.concat((0,E.default)(s[t],!0)));e=(0,S.default)(e);var r=Promise.resolve(),p=[];return e.forEach(function(e){e instanceof P.default?r=r.then(function(){return e.save()}):e instanceof x&&p.push(e)}),r.then(function(){var l=null;return(0,O.continueWhile)(function(){return 0<p.length},function(){var r,n,t=[],a=[];if(p.forEach(function(e){t.length<c&&(0,b.default)(e)?t.push(e):a.push(e)}),p=a,t.length<1)return Promise.reject(new w.default(w.default.OTHER_CAUSE,"Tried to save a batch with a cycle."));var o=new Promise(function(e,t){r=e,n=t});o.resolve=r,o.reject=n;var s=[],u=[];return t.forEach(function(a,i){var r,n,e=new Promise(function(e,t){r=e,n=t});e.resolve=r,e.reject=n,s.push(e),h.pushPendingState(a._getStateIdentifier()),u.push(h.enqueueTask(a._getStateIdentifier(),function(){return e.resolve(),o.then(function(e,t){if(e[i].hasOwnProperty("success")){var r=e[i].success.objectId;f[r]=a._localId,a._handleSaveResponse(e[i].success,t)}else{if(!l&&e[i].hasOwnProperty("error")){var n=e[i].error;l=new w.default(n.code,n.error),p=[]}a._handleSaveError()}})}))}),(0,O.when)(s).then(function(){return d.request("POST","batch",{requests:t.map(function(e){var t=e._getSaveParams();return t.path=T()+t.path,t})},i)}).then(function(e,t){o.resolve(e,t)},function(e){o.reject(new w.default(w.default.INCORRECT_TYPE,e.message))}),(0,O.when)(u)}).then((0,y.default)(v.default.mark(function e(){var t,r,n,a,i,o;return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l)return e.abrupt("return",Promise.reject(l));e.next=2;break;case 2:r=!(t=!0),n=void 0,e.prev=5,a=s[Symbol.iterator]();case 7:if(t=(i=a.next()).done){e.next=16;break}return o=i.value,e.next=11,u._updateLocalIdForObject(f[o.id],o);case 11:return e.next=13,u._updateObjectIfPinned(o);case 13:t=!0,e.next=7;break;case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(5),r=!0,n=e.t0;case 22:e.prev=22,e.prev=23,t||null==a.return||a.return();case 25:if(e.prev=25,r)throw n;e.next=28;break;case 28:return e.finish(25);case 29:return e.finish(22);case 30:return e.abrupt("return",Promise.resolve(s));case 31:case"end":return e.stop()}},e,this,[[5,18,22,30],[23,,25,29]])})))})}if(s instanceof x){var n=s._localId,a=s;return h.pushPendingState(s._getStateIdentifier()),h.enqueueTask(s._getStateIdentifier(),function(){var e=a._getSaveParams();return d.request(e.method,e.path,e.body,i).then(function(e,t){a._handleSaveResponse(e,t)},function(e){return a._handleSaveError(),Promise.reject(e)})}).then((0,y.default)(v.default.mark(function e(){return v.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u._updateLocalIdForObject(n,s);case 2:return e.next=4,u._updateObjectIfPinned(s);case 4:return e.abrupt("return",s);case 5:case"end":return e.stop()}},e,this)})),function(e){return Promise.reject(e)})}return Promise.resolve()}};g.default.setObjectController(D);var L=x;r.default=L},{"./CoreManager":3,"./ParseACL":14,"./ParseError":16,"./ParseFile":17,"./ParseOp":22,"./ParseQuery":24,"./ParseRelation":25,"./SingleInstanceStateController":32,"./UniqueInstanceStateController":36,"./canBeSerialized":38,"./decode":39,"./encode":40,"./escape":42,"./parseDate":44,"./promiseUtils":45,"./unique":46,"./unsavedChildren":47,"@babel/runtime/helpers/asyncToGenerator":50,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/interopRequireWildcard":59,"@babel/runtime/helpers/typeof":67,"@babel/runtime/regenerator":69}],22:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.opFromJSON=function(e){if(!e||!e.__op)return null;switch(e.__op){case"Delete":return new g;case"Increment":return new _(e.amount);case"Add":return new w((0,d.default)(e.objects));case"AddUnique":return new P((0,d.default)(e.objects));case"Remove":return new O((0,d.default)(e.objects));case"AddRelation":var t=(0,d.default)(e.objects);return Array.isArray(t)?new k(t,[]):new k([],[]);case"RemoveRelation":var r=(0,d.default)(e.objects);return Array.isArray(r)?new k([],r):new k([],[]);case"Batch":for(var n=[],a=[],i=0;i<e.ops.length;i++)"AddRelation"===e.ops[i].__op?n=n.concat((0,d.default)(e.ops[i].objects)):"RemoveRelation"===e.ops[i].__op&&(a=a.concat((0,d.default)(e.ops[i].objects)));return new k(n,a)}return null},r.RelationOp=r.RemoveOp=r.AddUniqueOp=r.AddOp=r.IncrementOp=r.UnsetOp=r.SetOp=r.Op=void 0;var i=n(e("@babel/runtime/helpers/possibleConstructorReturn")),o=n(e("@babel/runtime/helpers/getPrototypeOf")),s=n(e("@babel/runtime/helpers/inherits")),u=n(e("@babel/runtime/helpers/assertThisInitialized")),l=n(e("@babel/runtime/helpers/defineProperty")),c=n(e("@babel/runtime/helpers/classCallCheck")),f=n(e("@babel/runtime/helpers/createClass")),a=n(e("./arrayContainsObject")),d=n(e("./decode")),h=n(e("./encode")),p=n(e("./ParseObject")),v=n(e("./ParseRelation")),y=n(e("./unique"));var b=function(){function e(){(0,c.default)(this,e)}return(0,f.default)(e,[{key:"applyTo",value:function(){}},{key:"mergeWith",value:function(){}},{key:"toJSON",value:function(){}}]),e}(),m=function(e){function r(e){var t;return(0,c.default)(this,r),t=(0,i.default)(this,(0,o.default)(r).call(this)),(0,l.default)((0,u.default)((0,u.default)(t)),"_value",void 0),t._value=e,t}return(0,s.default)(r,e),(0,f.default)(r,[{key:"applyTo",value:function(){return this._value}},{key:"mergeWith",value:function(){return new r(this._value)}},{key:"toJSON",value:function(){return(0,h.default)(this._value,!1,!0)}}]),r}(r.Op=b);r.SetOp=m;var g=function(e){function t(){return(0,c.default)(this,t),(0,i.default)(this,(0,o.default)(t).apply(this,arguments))}return(0,s.default)(t,e),(0,f.default)(t,[{key:"applyTo",value:function(){}},{key:"mergeWith",value:function(){return new t}},{key:"toJSON",value:function(){return{__op:"Delete"}}}]),t}(b);r.UnsetOp=g;var _=function(e){function r(e){var t;if((0,c.default)(this,r),t=(0,i.default)(this,(0,o.default)(r).call(this)),(0,l.default)((0,u.default)((0,u.default)(t)),"_amount",void 0),"number"!=typeof e)throw new TypeError("Increment Op must be initialized with a numeric amount.");return t._amount=e,t}return(0,s.default)(r,e),(0,f.default)(r,[{key:"applyTo",value:function(e){if(void 0===e)return this._amount;if("number"!=typeof e)throw new TypeError("Cannot increment a non-numeric value.");return this._amount+e}},{key:"mergeWith",value:function(e){if(!e)return this;if(e instanceof m)return new m(this.applyTo(e._value));if(e instanceof g)return new m(this._amount);if(e instanceof r)return new r(this.applyTo(e._amount));throw new Error("Cannot merge Increment Op with the previous Op")}},{key:"toJSON",value:function(){return{__op:"Increment",amount:this._amount}}}]),r}(b);r.IncrementOp=_;var w=function(e){function r(e){var t;return(0,c.default)(this,r),t=(0,i.default)(this,(0,o.default)(r).call(this)),(0,l.default)((0,u.default)((0,u.default)(t)),"_value",void 0),t._value=Array.isArray(e)?e:[e],t}return(0,s.default)(r,e),(0,f.default)(r,[{key:"applyTo",value:function(e){if(null==e)return this._value;if(Array.isArray(e))return e.concat(this._value);throw new Error("Cannot add elements to a non-array value")}},{key:"mergeWith",value:function(e){if(!e)return this;if(e instanceof m)return new m(this.applyTo(e._value));if(e instanceof g)return new m(this._value);if(e instanceof r)return new r(this.applyTo(e._value));throw new Error("Cannot merge Add Op with the previous Op")}},{key:"toJSON",value:function(){return{__op:"Add",objects:(0,h.default)(this._value,!1,!0)}}}]),r}(b);r.AddOp=w;var P=function(e){function r(e){var t;return(0,c.default)(this,r),t=(0,i.default)(this,(0,o.default)(r).call(this)),(0,l.default)((0,u.default)((0,u.default)(t)),"_value",void 0),t._value=(0,y.default)(Array.isArray(e)?e:[e]),t}return(0,s.default)(r,e),(0,f.default)(r,[{key:"applyTo",value:function(e){if(null==e)return this._value||[];if(Array.isArray(e)){var t=e,r=[];return this._value.forEach(function(e){e instanceof p.default?(0,a.default)(t,e)||r.push(e):t.indexOf(e)<0&&r.push(e)}),e.concat(r)}throw new Error("Cannot add elements to a non-array value")}},{key:"mergeWith",value:function(e){if(!e)return this;if(e instanceof m)return new m(this.applyTo(e._value));if(e instanceof g)return new m(this._value);if(e instanceof r)return new r(this.applyTo(e._value));throw new Error("Cannot merge AddUnique Op with the previous Op")}},{key:"toJSON",value:function(){return{__op:"AddUnique",objects:(0,h.default)(this._value,!1,!0)}}}]),r}(b);r.AddUniqueOp=P;var O=function(e){function n(e){var t;return(0,c.default)(this,n),t=(0,i.default)(this,(0,o.default)(n).call(this)),(0,l.default)((0,u.default)((0,u.default)(t)),"_value",void 0),t._value=(0,y.default)(Array.isArray(e)?e:[e]),t}return(0,s.default)(n,e),(0,f.default)(n,[{key:"applyTo",value:function(e){if(null==e)return[];if(Array.isArray(e)){for(var t=e.concat([]),r=0;r<this._value.length;r++){for(var n=t.indexOf(this._value[r]);-1<n;)t.splice(n,1),n=t.indexOf(this._value[r]);if(this._value[r]instanceof p.default&&this._value[r].id)for(var a=0;a<t.length;a++)t[a]instanceof p.default&&this._value[r].id===t[a].id&&(t.splice(a,1),a--)}return t}throw new Error("Cannot remove elements from a non-array value")}},{key:"mergeWith",value:function(e){if(!e)return this;if(e instanceof m)return new m(this.applyTo(e._value));if(e instanceof g)return new g;if(e instanceof n){for(var t=e._value.concat([]),r=0;r<this._value.length;r++)this._value[r]instanceof p.default?(0,a.default)(t,this._value[r])||t.push(this._value[r]):t.indexOf(this._value[r])<0&&t.push(this._value[r]);return new n(t)}throw new Error("Cannot merge Remove Op with the previous Op")}},{key:"toJSON",value:function(){return{__op:"Remove",objects:(0,h.default)(this._value,!1,!0)}}}]),n}(b);r.RemoveOp=O;var k=function(e){function a(e,t){var r;return(0,c.default)(this,a),r=(0,i.default)(this,(0,o.default)(a).call(this)),(0,l.default)((0,u.default)((0,u.default)(r)),"_targetClassName",void 0),(0,l.default)((0,u.default)((0,u.default)(r)),"relationsToAdd",void 0),(0,l.default)((0,u.default)((0,u.default)(r)),"relationsToRemove",void 0),r._targetClassName=null,Array.isArray(e)&&(r.relationsToAdd=(0,y.default)(e.map(r._extractId,(0,u.default)((0,u.default)(r))))),Array.isArray(t)&&(r.relationsToRemove=(0,y.default)(t.map(r._extractId,(0,u.default)((0,u.default)(r))))),r}return(0,s.default)(a,e),(0,f.default)(a,[{key:"_extractId",value:function(e){if("string"==typeof e)return e;if(!e.id)throw new Error("You cannot add or remove an unsaved Parse Object from a relation");if(this._targetClassName||(this._targetClassName=e.className),this._targetClassName!==e.className)throw new Error("Tried to create a Relation with 2 different object types: "+this._targetClassName+" and "+e.className+".");return e.id}},{key:"applyTo",value:function(e,t,r){if(!e){if(!t||!r)throw new Error("Cannot apply a RelationOp without either a previous value, or an object and a key");var n=new p.default(t.className);t.id&&0===t.id.indexOf("local")?n._localId=t.id:t.id&&(n.id=t.id);var a=new v.default(n,r);return a.targetClassName=this._targetClassName,a}if(e instanceof v.default){if(this._targetClassName)if(e.targetClassName){if(this._targetClassName!==e.targetClassName)throw new Error("Related object must be a "+e.targetClassName+", but a "+this._targetClassName+" was passed in.")}else e.targetClassName=this._targetClassName;return e}throw new Error("Relation cannot be applied to a non-relation field")}},{key:"mergeWith",value:function(e){if(!e)return this;if(e instanceof g)throw new Error("You cannot modify a relation after deleting it.");if(e instanceof m&&e._value instanceof v.default)return this;if(e instanceof a){if(e._targetClassName&&e._targetClassName!==this._targetClassName)throw new Error("Related object must be of class "+e._targetClassName+", but "+(this._targetClassName||"null")+" was passed in.");var r=e.relationsToAdd.concat([]);this.relationsToRemove.forEach(function(e){var t=r.indexOf(e);-1<t&&r.splice(t,1)}),this.relationsToAdd.forEach(function(e){r.indexOf(e)<0&&r.push(e)});var n=e.relationsToRemove.concat([]);this.relationsToAdd.forEach(function(e){var t=n.indexOf(e);-1<t&&n.splice(t,1)}),this.relationsToRemove.forEach(function(e){n.indexOf(e)<0&&n.push(e)});var t=new a(r,n);return t._targetClassName=this._targetClassName,t}throw new Error("Cannot merge Relation Op with the previous Op")}},{key:"toJSON",value:function(){var t=this,e=function(e){return{__type:"Pointer",className:t._targetClassName,objectId:e}},r=null,n=null;return 0<this.relationsToAdd.length&&(r={__op:"AddRelation",objects:this.relationsToAdd.map(e)}),0<this.relationsToRemove.length&&(n={__op:"RemoveRelation",objects:this.relationsToRemove.map(e)}),r&&n?{__op:"Batch",ops:[r,n]}:r||n||{}}}]),a}(b);r.RelationOp=k},{"./ParseObject":21,"./ParseRelation":25,"./arrayContainsObject":37,"./decode":39,"./encode":40,"./unique":46,"@babel/runtime/helpers/assertThisInitialized":49,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/getPrototypeOf":56,"@babel/runtime/helpers/inherits":57,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/possibleConstructorReturn":63}],23:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/createClass")),o=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("./ParseGeoPoint")),u=function(){function n(e){(0,a.default)(this,n),(0,o.default)(this,"_coordinates",void 0),this._coordinates=n._validate(e)}return(0,i.default)(n,[{key:"toJSON",value:function(){return n._validate(this._coordinates),{__type:"Polygon",coordinates:this._coordinates}}},{key:"equals",value:function(e){if(!(e instanceof n)||this.coordinates.length!==e.coordinates.length)return!1;for(var t=!0,r=1;r<this._coordinates.length;r+=1)if(this._coordinates[r][0]!=e.coordinates[r][0]||this._coordinates[r][1]!=e.coordinates[r][1]){t=!1;break}return t}},{key:"containsPoint",value:function(e){for(var t=this._coordinates[0][0],r=this._coordinates[0][0],n=this._coordinates[0][1],a=this._coordinates[0][1],i=1;i<this._coordinates.length;i+=1){var o=this._coordinates[i];t=Math.min(o[0],t),r=Math.max(o[0],r),n=Math.min(o[1],n),a=Math.max(o[1],a)}if(e.latitude<t||e.latitude>r||e.longitude<n||e.longitude>a)return!1;for(var s=!1,u=0,l=this._coordinates.length-1;u<this._coordinates.length;l=u++){var c=this._coordinates[u][0],f=this._coordinates[u][1],d=this._coordinates[l][0],h=this._coordinates[l][1];f>e.longitude!=h>e.longitude&&e.latitude<(d-c)*(e.longitude-f)/(h-f)+c&&(s=!s)}return s}},{key:"coordinates",get:function(){return this._coordinates},set:function(e){this._coordinates=n._validate(e)}}],[{key:"_validate",value:function(e){if(!Array.isArray(e))throw new TypeError("Coordinates must be an Array");if(e.length<3)throw new TypeError("Polygon must have at least 3 GeoPoints or Points");for(var t=[],r=0;r<e.length;r+=1){var n=e[r],a=void 0;if(n instanceof s.default)a=n;else{if(!Array.isArray(n)||2!==n.length)throw new TypeError("Coordinates must be an Array of GeoPoints or Points");a=new s.default(n[0],n[1])}t.push([a.latitude,a.longitude])}return t}}]),n}();r.default=u},{"./ParseGeoPoint":18,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/interopRequireDefault":58}],24:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var c=n(e("@babel/runtime/helpers/typeof")),f=n(e("@babel/runtime/regenerator")),a=n(e("@babel/runtime/helpers/asyncToGenerator")),i=n(e("@babel/runtime/helpers/classCallCheck")),o=n(e("@babel/runtime/helpers/createClass")),s=n(e("@babel/runtime/helpers/defineProperty")),d=n(e("./CoreManager")),u=n(e("./encode")),h=e("./promiseUtils"),p=n(e("./ParseError")),v=n(e("./ParseGeoPoint")),y=n(e("./ParseObject")),b=n(e("./OfflineQuery"));function m(e){return"\\Q"+e.replace("\\E","\\E\\\\E\\Q")+"\\E"}function g(e){var t=null;return e.forEach(function(e){if(t||(t=e.className),t!==e.className)throw new Error("All queries must be for the same class.")}),t}function _(i,e){var o={};(e.forEach(function(e){var t=-1!==e.indexOf(".");if(t||i.hasOwnProperty(e)){if(t){var r=e.split("."),n=i,a=o;r.forEach(function(e,t,r){n&&!n.hasOwnProperty(e)&&(n[e]=void 0),void 0!==n&&(n=n[e]),t<r.length-1&&(a[e]||(a[e]={}),a=a[e])})}}else i[e]=void 0}),0<Object.keys(o).length)&&function e(t,r,n,a){if(a)for(var i in t)t.hasOwnProperty(i)&&!r.hasOwnProperty(i)&&(r[i]=t[i]);for(var o in n)void 0!==r[o]&&null!==r[o]&&null!=t&&e(t[o],r[o],n[o],!0)}(d.default.getObjectStateController().getServerData({id:i.objectId,className:i.className}),i,o,!1)}function w(e,t,r){var n=r[0],a="-"===n.slice(0,1);if(a&&(n=n.substring(1)),"_created_at"===n&&(n="createdAt"),"_updated_at"===n&&(n="updatedAt"),!/^[A-Za-z][0-9A-Za-z_]*$/.test(n)||"password"===n)throw new p.default(p.default.INVALID_KEY_NAME,"Invalid Key: ".concat(n));var i=e.get(n),o=t.get(n);return i<o?a?1:-1:o<i?a?-1:1:1<r.length?w(e,t,r.slice(1)):0}var l=function(){function l(e){if((0,i.default)(this,l),(0,s.default)(this,"className",void 0),(0,s.default)(this,"_where",void 0),(0,s.default)(this,"_include",void 0),(0,s.default)(this,"_select",void 0),(0,s.default)(this,"_limit",void 0),(0,s.default)(this,"_skip",void 0),(0,s.default)(this,"_order",void 0),(0,s.default)(this,"_queriesLocalDatastore",void 0),(0,s.default)(this,"_localDatastorePinName",void 0),(0,s.default)(this,"_extraOptions",void 0),"string"==typeof e)"User"===e&&d.default.get("PERFORM_USER_REWRITE")?this.className="_User":this.className=e;else if(e instanceof y.default)this.className=e.className;else{if("function"!=typeof e)throw new TypeError("A ParseQuery must be constructed with a ParseObject or class name.");if("string"==typeof e.className)this.className=e.className;else{var t=new e;this.className=t.className}}this._where={},this._include=[],this._limit=-1,this._skip=0,this._queriesLocalDatastore=!1,this._localDatastorePinName=null,this._extraOptions={}}var e;return(0,o.default)(l,[{key:"_orQuery",value:function(e){var t=e.map(function(e){return e.toJSON().where});return this._where.$or=t,this}},{key:"_andQuery",value:function(e){var t=e.map(function(e){return e.toJSON().where});return this._where.$and=t,this}},{key:"_norQuery",value:function(e){var t=e.map(function(e){return e.toJSON().where});return this._where.$nor=t,this}},{key:"_addCondition",value:function(e,t,r){return this._where[e]&&"string"!=typeof this._where[e]||(this._where[e]={}),this._where[e][t]=(0,u.default)(r,!1,!0),this}},{key:"_regexStartWith",value:function(e){return"^"+m(e)}},{key:"_handleOfflineQuery",value:(e=(0,a.default)(f.default.mark(function e(t){var r,n,a,i,o,s,u,l=this;return f.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return b.default.validateQuery(this),r=d.default.getLocalDatastore(),e.next=4,r._serializeObjectsFromPinName(this._localDatastorePinName);case 4:return n=e.sent,a=n.map(function(e,t,r){var n=y.default.fromJSON(e,!1);return b.default.matchesQuery(l.className,n,r,l)?n:null}).filter(function(e){return null!==e}),t.keys&&(i=t.keys.split(","),o=["className","objectId","createdAt","updatedAt","ACL"],i=i.concat(o),a=a.map(function(e){var t=e._toFullJSON();return Object.keys(t).forEach(function(e){i.includes(e)||delete t[e]}),y.default.fromJSON(t,!1)})),t.order&&(s=t.order.split(","),a.sort(function(e,t){return w(e,t,s)})),t.skip&&(a=t.skip>=a.length?[]:a.splice(t.skip,a.length)),u=a.length,0!==t.limit&&t.limit<a.length&&(u=t.limit),a=a.splice(0,u),e.abrupt("return",a);case 13:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"toJSON",value:function(){var e={where:this._where};for(var t in this._include.length&&(e.include=this._include.join(",")),this._select&&(e.keys=this._select.join(",")),0<=this._limit&&(e.limit=this._limit),0<this._skip&&(e.skip=this._skip),this._order&&(e.order=this._order.join(",")),this._extraOptions)e[t]=this._extraOptions[t];return e}},{key:"withJSON",value:function(e){for(var t in e.where&&(this._where=e.where),e.include&&(this._include=e.include.split(",")),e.keys&&(this._select=e.keys.split(",")),e.limit&&(this._limit=e.limit),e.skip&&(this._skip=e.skip),e.order&&(this._order=e.order.split(",")),e)e.hasOwnProperty(t)&&-1===["where","include","keys","limit","skip","order"].indexOf(t)&&(this._extraOptions[t]=e[t]);return this}},{key:"get",value:function(e,t){this.equalTo("objectId",e);var r={};return t&&t.hasOwnProperty("useMasterKey")&&(r.useMasterKey=t.useMasterKey),t&&t.hasOwnProperty("sessionToken")&&(r.sessionToken=t.sessionToken),this.first(r).then(function(e){if(e)return e;var t=new p.default(p.default.OBJECT_NOT_FOUND,"Object not found.");return Promise.reject(t)})}},{key:"find",value:function(e){var n=this,t={};(e=e||{}).hasOwnProperty("useMasterKey")&&(t.useMasterKey=e.useMasterKey),e.hasOwnProperty("sessionToken")&&(t.sessionToken=e.sessionToken);var r=d.default.getQueryController(),a=this._select;return this._queriesLocalDatastore?this._handleOfflineQuery(this.toJSON()):r.find(this.className,this.toJSON(),t).then(function(r){return r.results.map(function(e){var t=r.className||n.className;return e.className||(e.className=t),a&&_(e,a),y.default.fromJSON(e,!a)})})}},{key:"count",value:function(e){var t={};(e=e||{}).hasOwnProperty("useMasterKey")&&(t.useMasterKey=e.useMasterKey),e.hasOwnProperty("sessionToken")&&(t.sessionToken=e.sessionToken);var r=d.default.getQueryController(),n=this.toJSON();return n.limit=0,n.count=1,r.find(this.className,n,t).then(function(e){return e.count})}},{key:"distinct",value:function(e,t){var r={useMasterKey:!0};(t=t||{}).hasOwnProperty("sessionToken")&&(r.sessionToken=t.sessionToken);var n=d.default.getQueryController(),a={distinct:e,where:this._where};return n.aggregate(this.className,a,r).then(function(e){return e.results})}},{key:"aggregate",value:function(e,t){var r={useMasterKey:!0};(t=t||{}).hasOwnProperty("sessionToken")&&(r.sessionToken=t.sessionToken);var n=d.default.getQueryController();if(!Array.isArray(e)&&"object"!==(0,c.default)(e))throw new Error("Invalid pipeline must be Array or Object");return n.aggregate(this.className,{pipeline:e},r).then(function(e){return e.results})}},{key:"first",value:function(e){var r=this,t={};(e=e||{}).hasOwnProperty("useMasterKey")&&(t.useMasterKey=e.useMasterKey),e.hasOwnProperty("sessionToken")&&(t.sessionToken=e.sessionToken);var n=d.default.getQueryController(),a=this.toJSON();a.limit=1;var i=this._select;return this._queriesLocalDatastore?this._handleOfflineQuery(a).then(function(e){if(e[0])return e[0]}):n.find(this.className,a,t).then(function(e){var t=e.results;if(t[0])return t[0].className||(t[0].className=r.className),i&&_(t[0],i),y.default.fromJSON(t[0],!i)})}},{key:"each",value:function(r,e){if(e=e||{},this._order||this._skip||0<=this._limit)return Promise.reject("Cannot iterate on a query with sort, skip, or limit.");var n=new l(this.className);for(var t in n._limit=e.batchSize||100,n._include=this._include.map(function(e){return e}),this._select&&(n._select=this._select.map(function(e){return e})),n._where={},this._where){var a=this._where[t];if(Array.isArray(a))n._where[t]=a.map(function(e){return e});else if(a&&"object"===(0,c.default)(a)){var i={};for(var o in n._where[t]=i,a)i[o]=a[o]}else n._where[t]=a}n.ascending("objectId");var s={};e.hasOwnProperty("useMasterKey")&&(s.useMasterKey=e.useMasterKey),e.hasOwnProperty("sessionToken")&&(s.sessionToken=e.sessionToken);var u=!1;return(0,h.continueWhile)(function(){return!u},function(){return n.find(s).then(function(e){var t=Promise.resolve();return e.forEach(function(e){t=t.then(function(){return r(e)})}),t.then(function(){e.length>=n._limit?n.greaterThan("objectId",e[e.length-1].id):u=!0})})})}},{key:"equalTo",value:function(e,t){return void 0===t?this.doesNotExist(e):(this._where[e]=(0,u.default)(t,!1,!0),this)}},{key:"notEqualTo",value:function(e,t){return this._addCondition(e,"$ne",t)}},{key:"lessThan",value:function(e,t){return this._addCondition(e,"$lt",t)}},{key:"greaterThan",value:function(e,t){return this._addCondition(e,"$gt",t)}},{key:"lessThanOrEqualTo",value:function(e,t){return this._addCondition(e,"$lte",t)}},{key:"greaterThanOrEqualTo",value:function(e,t){return this._addCondition(e,"$gte",t)}},{key:"containedIn",value:function(e,t){return this._addCondition(e,"$in",t)}},{key:"notContainedIn",value:function(e,t){return this._addCondition(e,"$nin",t)}},{key:"containedBy",value:function(e,t){return this._addCondition(e,"$containedBy",t)}},{key:"containsAll",value:function(e,t){return this._addCondition(e,"$all",t)}},{key:"containsAllStartingWith",value:function(e,t){var r=this;return Array.isArray(t)||(t=[t]),t=t.map(function(e){return{$regex:r._regexStartWith(e)}}),this.containsAll(e,t)}},{key:"exists",value:function(e){return this._addCondition(e,"$exists",!0)}},{key:"doesNotExist",value:function(e){return this._addCondition(e,"$exists",!1)}},{key:"matches",value:function(e,t,r){return this._addCondition(e,"$regex",t),r||(r=""),t.ignoreCase&&(r+="i"),t.multiline&&(r+="m"),r.length&&this._addCondition(e,"$options",r),this}},{key:"matchesQuery",value:function(e,t){var r=t.toJSON();return r.className=t.className,this._addCondition(e,"$inQuery",r)}},{key:"doesNotMatchQuery",value:function(e,t){var r=t.toJSON();return r.className=t.className,this._addCondition(e,"$notInQuery",r)}},{key:"matchesKeyInQuery",value:function(e,t,r){var n=r.toJSON();return n.className=r.className,this._addCondition(e,"$select",{key:t,query:n})}},{key:"doesNotMatchKeyInQuery",value:function(e,t,r){var n=r.toJSON();return n.className=r.className,this._addCondition(e,"$dontSelect",{key:t,query:n})}},{key:"contains",value:function(e,t){if("string"!=typeof t)throw new Error("The value being searched for must be a string.");return this._addCondition(e,"$regex",m(t))}},{key:"fullText",value:function(e,t,r){if(r=r||{},!e)throw new Error("A key is required.");if(!t)throw new Error("A search term is required");if("string"!=typeof t)throw new Error("The value being searched for must be a string.");var n={$term:t};for(var a in r)switch(a){case"language":n.$language=r[a];break;case"caseSensitive":n.$caseSensitive=r[a];break;case"diacriticSensitive":n.$diacriticSensitive=r[a];break;default:throw new Error("Unknown option: ".concat(a))}return this._addCondition(e,"$text",{$search:n})}},{key:"sortByTextScore",value:function(){return this.ascending("$score"),this.select(["$score"]),this}},{key:"startsWith",value:function(e,t){if("string"!=typeof t)throw new Error("The value being searched for must be a string.");return this._addCondition(e,"$regex",this._regexStartWith(t))}},{key:"endsWith",value:function(e,t){if("string"!=typeof t)throw new Error("The value being searched for must be a string.");return this._addCondition(e,"$regex",m(t)+"$")}},{key:"near",value:function(e,t){return t instanceof v.default||(t=new v.default(t)),this._addCondition(e,"$nearSphere",t)}},{key:"withinRadians",value:function(e,t,r,n){return n||void 0===n?(this.near(e,t),this._addCondition(e,"$maxDistance",r)):this._addCondition(e,"$geoWithin",{$centerSphere:[[t.longitude,t.latitude],r]})}},{key:"withinMiles",value:function(e,t,r,n){return this.withinRadians(e,t,r/3958.8,n)}},{key:"withinKilometers",value:function(e,t,r,n){return this.withinRadians(e,t,r/6371,n)}},{key:"withinGeoBox",value:function(e,t,r){return t instanceof v.default||(t=new v.default(t)),r instanceof v.default||(r=new v.default(r)),this._addCondition(e,"$within",{$box:[t,r]}),this}},{key:"withinPolygon",value:function(e,t){return this._addCondition(e,"$geoWithin",{$polygon:t})}},{key:"polygonContains",value:function(e,t){return this._addCondition(e,"$geoIntersects",{$point:t})}},{key:"ascending",value:function(){this._order=[];for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.addAscending.apply(this,t)}},{key:"addAscending",value:function(){var t=this;this._order||(this._order=[]);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach(function(e){Array.isArray(e)&&(e=e.join()),t._order=t._order.concat(e.replace(/\s/g,"").split(","))}),this}},{key:"descending",value:function(){this._order=[];for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.addDescending.apply(this,t)}},{key:"addDescending",value:function(){var t=this;this._order||(this._order=[]);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach(function(e){Array.isArray(e)&&(e=e.join()),t._order=t._order.concat(e.replace(/\s/g,"").split(",").map(function(e){return"-"+e}))}),this}},{key:"skip",value:function(e){if("number"!=typeof e||e<0)throw new Error("You can only skip by a positive number");return this._skip=e,this}},{key:"limit",value:function(e){if("number"!=typeof e)throw new Error("You can only set the limit to a numeric value");return this._limit=e,this}},{key:"include",value:function(){for(var t=this,e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach(function(e){Array.isArray(e)?t._include=t._include.concat(e):t._include.push(e)}),this}},{key:"includeAll",value:function(){return this.include("*")}},{key:"select",value:function(){var t=this;this._select||(this._select=[]);for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach(function(e){Array.isArray(e)?t._select=t._select.concat(e):t._select.push(e)}),this}},{key:"subscribe",value:function(){return d.default.getLiveQueryController().subscribe(this)}},{key:"fromLocalDatastore",value:function(){this.fromPinWithName(null)}},{key:"fromPin",value:function(){var e=d.default.getLocalDatastore();this.fromPinWithName(e.DEFAULT_PIN)}},{key:"fromPinWithName",value:function(e){d.default.getLocalDatastore().checkIfEnabled()&&(this._queriesLocalDatastore=!0,this._localDatastorePinName=e)}}],[{key:"fromJSON",value:function(e,t){return new l(e).withJSON(t)}},{key:"or",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new l(g(t));return n._orQuery(t),n}},{key:"and",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new l(g(t));return n._andQuery(t),n}},{key:"nor",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var n=new l(g(t));return n._norQuery(t),n}}]),l}(),P={find:function(e,t,r){return d.default.getRESTController().request("GET","classes/"+e,t,r)},aggregate:function(e,t,r){return d.default.getRESTController().request("GET","aggregate/"+e,t,r)}};d.default.setQueryController(P);var O=l;r.default=O},{"./CoreManager":3,"./OfflineQuery":12,"./ParseError":16,"./ParseGeoPoint":18,"./ParseObject":21,"./encode":40,"./promiseUtils":45,"@babel/runtime/helpers/asyncToGenerator":50,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67,"@babel/runtime/regenerator":69}],25:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/createClass")),o=n(e("@babel/runtime/helpers/defineProperty")),s=e("./ParseOp"),u=(n(e("./ParseObject")),n(e("./ParseQuery"))),l=function(){function r(e,t){(0,a.default)(this,r),(0,o.default)(this,"parent",void 0),(0,o.default)(this,"key",void 0),(0,o.default)(this,"targetClassName",void 0),this.parent=e,this.key=t,this.targetClassName=null}return(0,i.default)(r,[{key:"_ensureParentAndKey",value:function(e,t){if(this.key=this.key||t,this.key!==t)throw new Error("Internal Error. Relation retrieved from two different keys.");if(this.parent){if(this.parent.className!==e.className)throw new Error("Internal Error. Relation retrieved from two different Objects.");if(this.parent.id){if(this.parent.id!==e.id)throw new Error("Internal Error. Relation retrieved from two different Objects.")}else e.id&&(this.parent=e)}else this.parent=e}},{key:"add",value:function(e){Array.isArray(e)||(e=[e]);var t=new s.RelationOp(e,[]),r=this.parent;if(!r)throw new Error("Cannot add to a Relation without a parent");return r.set(this.key,t),this.targetClassName=t._targetClassName,r}},{key:"remove",value:function(e){Array.isArray(e)||(e=[e]);var t=new s.RelationOp([],e);if(!this.parent)throw new Error("Cannot remove from a Relation without a parent");this.parent.set(this.key,t),this.targetClassName=t._targetClassName}},{key:"toJSON",value:function(){return{__type:"Relation",className:this.targetClassName}}},{key:"query",value:function(){var e,t=this.parent;if(!t)throw new Error("Cannot construct a query for a Relation without a parent");return this.targetClassName?e=new u.default(this.targetClassName):(e=new u.default(t.className),e._extraOptions.redirectClassNameForKey=this.key),e._addCondition("$relatedTo","object",{__type:"Pointer",className:t.className,objectId:t.id}),e._addCondition("$relatedTo","key",this.key),e}}]),r}();r.default=l},{"./ParseObject":21,"./ParseOp":22,"./ParseQuery":24,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/interopRequireDefault":58}],26:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var i=n(e("@babel/runtime/helpers/classCallCheck")),o=n(e("@babel/runtime/helpers/createClass")),s=n(e("@babel/runtime/helpers/possibleConstructorReturn")),u=n(e("@babel/runtime/helpers/getPrototypeOf")),l=n(e("@babel/runtime/helpers/get")),c=n(e("@babel/runtime/helpers/inherits")),f=n(e("./ParseACL")),d=n(e("./ParseError")),a=n(e("./ParseObject")),h=function(e){function a(e,t){var r;return(0,i.default)(this,a),r=(0,s.default)(this,(0,u.default)(a).call(this,"_Role")),"string"==typeof e&&t instanceof f.default&&(r.setName(e),r.setACL(t)),r}return(0,c.default)(a,e),(0,o.default)(a,[{key:"getName",value:function(){var e=this.get("name");return null==e||"string"==typeof e?e:""}},{key:"setName",value:function(e,t){return this.set("name",e,t)}},{key:"getUsers",value:function(){return this.relation("users")}},{key:"getRoles",value:function(){return this.relation("roles")}},{key:"validate",value:function(e,t){var r=(0,l.default)((0,u.default)(a.prototype),"validate",this).call(this,e,t);if(r)return r;if("name"in e&&e.name!==this.getName()){var n=e.name;if(this.id&&this.id!==e.objectId)return new d.default(d.default.OTHER_CAUSE,"A role's name can only be set before it has been saved.");if("string"!=typeof n)return new d.default(d.default.OTHER_CAUSE,"A role's name must be a String.");if(!/^[0-9a-zA-Z\-_ ]+$/.test(n))return new d.default(d.default.OTHER_CAUSE,"A role's name can be only contain alphanumeric characters, _, -, and spaces.")}return!1}}]),a}(a.default);a.default.registerSubclass("_Role",h);var p=h;r.default=p},{"./ParseACL":14,"./ParseError":16,"./ParseObject":21,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/get":55,"@babel/runtime/helpers/getPrototypeOf":56,"@babel/runtime/helpers/inherits":57,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/possibleConstructorReturn":63}],27:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/createClass")),o=n(e("@babel/runtime/helpers/defineProperty")),s=n(e("./CoreManager")),u=["String","Number","Boolean","Date","File","GeoPoint","Polygon","Array","Object","Pointer","Relation"],l=function(){function t(e){(0,a.default)(this,t),(0,o.default)(this,"className",void 0),(0,o.default)(this,"_fields",void 0),(0,o.default)(this,"_indexes",void 0),"string"==typeof e&&("User"===e&&s.default.get("PERFORM_USER_REWRITE")?this.className="_User":this.className=e),this._fields={},this._indexes={}}return(0,i.default)(t,[{key:"get",value:function(e){return this.assertClassName(),e=e||{},s.default.getSchemaController().get(this.className,e).then(function(e){if(!e)throw new Error("Schema not found.");return e})}},{key:"save",value:function(e){this.assertClassName(),e=e||{};var t=s.default.getSchemaController(),r={className:this.className,fields:this._fields,indexes:this._indexes};return t.create(this.className,r,e).then(function(e){return e})}},{key:"update",value:function(e){this.assertClassName(),e=e||{};var t=s.default.getSchemaController(),r={className:this.className,fields:this._fields,indexes:this._indexes};return this._fields={},this._indexes={},t.update(this.className,r,e).then(function(e){return e})}},{key:"delete",value:function(e){return this.assertClassName(),e=e||{},s.default.getSchemaController().delete(this.className,e).then(function(e){return e})}},{key:"purge",value:function(){return this.assertClassName(),s.default.getSchemaController().purge(this.className).then(function(e){return e})}},{key:"assertClassName",value:function(){if(!this.className)throw new Error("You must set a Class Name before making any request.")}},{key:"addField",value:function(e,t){if(t=t||"String",!e)throw new Error("field name may not be null.");if(-1===u.indexOf(t))throw new Error("".concat(t," is not a valid type."));return this._fields[e]={type:t},this}},{key:"addIndex",value:function(e,t){if(!e)throw new Error("index name may not be null.");if(!t)throw new Error("index may not be null.");return this._indexes[e]=t,this}},{key:"addString",value:function(e){return this.addField(e,"String")}},{key:"addNumber",value:function(e){return this.addField(e,"Number")}},{key:"addBoolean",value:function(e){return this.addField(e,"Boolean")}},{key:"addDate",value:function(e){return this.addField(e,"Date")}},{key:"addFile",value:function(e){return this.addField(e,"File")}},{key:"addGeoPoint",value:function(e){return this.addField(e,"GeoPoint")}},{key:"addPolygon",value:function(e){return this.addField(e,"Polygon")}},{key:"addArray",value:function(e){return this.addField(e,"Array")}},{key:"addObject",value:function(e){return this.addField(e,"Object")}},{key:"addPointer",value:function(e,t){if(!e)throw new Error("field name may not be null.");if(!t)throw new Error("You need to set the targetClass of the Pointer.");return this._fields[e]={type:"Pointer",targetClass:t},this}},{key:"addRelation",value:function(e,t){if(!e)throw new Error("field name may not be null.");if(!t)throw new Error("You need to set the targetClass of the Relation.");return this._fields[e]={type:"Relation",targetClass:t},this}},{key:"deleteField",value:function(e){this._fields[e]={__op:"Delete"}}},{key:"deleteIndex",value:function(e){this._indexes[e]={__op:"Delete"}}}],[{key:"all",value:function(e){return e=e||{},s.default.getSchemaController().get("",e).then(function(e){if(0===e.results.length)throw new Error("Schema not found.");return e.results})}}]),t}(),c={send:function(e,t,r,n){var a=s.default.getRESTController(),i={useMasterKey:!0};return n.hasOwnProperty("sessionToken")&&(i.sessionToken=n.sessionToken),a.request(t,"schemas/".concat(e),r,i)},get:function(e,t){return this.send(e,"GET",{},t)},create:function(e,t,r){return this.send(e,"POST",t,r)},update:function(e,t,r){return this.send(e,"PUT",t,r)},delete:function(e,t){return this.send(e,"DELETE",{},t)},purge:function(e){return s.default.getRESTController().request("DELETE","purge/".concat(e),{},{useMasterKey:!0})}};s.default.setSchemaController(c);var f=l;r.default=f},{"./CoreManager":3,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/interopRequireDefault":58}],28:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=n(e("@babel/runtime/helpers/typeof")),i=n(e("@babel/runtime/helpers/classCallCheck")),o=n(e("@babel/runtime/helpers/createClass")),s=n(e("@babel/runtime/helpers/possibleConstructorReturn")),u=n(e("@babel/runtime/helpers/getPrototypeOf")),l=n(e("@babel/runtime/helpers/inherits")),c=n(e("./CoreManager")),f=n(e("./isRevocableSession")),d=n(e("./ParseObject")),h=n(e("./ParseUser")),p=function(e){function r(e){var t;if((0,i.default)(this,r),t=(0,s.default)(this,(0,u.default)(r).call(this,"_Session")),e&&"object"===(0,a.default)(e)&&!t.set(e||{}))throw new Error("Can't create an invalid Session");return t}return(0,l.default)(r,e),(0,o.default)(r,[{key:"getSessionToken",value:function(){var e=this.get("sessionToken");return"string"==typeof e?e:""}}],[{key:"readOnlyAttributes",value:function(){return["createdWith","expiresAt","installationId","restricted","sessionToken","user"]}},{key:"current",value:function(e){e=e||{};var t=c.default.getSessionController(),r={};return e.hasOwnProperty("useMasterKey")&&(r.useMasterKey=e.useMasterKey),h.default.currentAsync().then(function(e){return e?(r.sessionToken=e.getSessionToken(),t.getSession(r)):Promise.reject("There is no current user.")})}},{key:"isCurrentSessionRevocable",value:function(){var e=h.default.current();return!!e&&(0,f.default)(e.getSessionToken()||"")}}]),r}(d.default);d.default.registerSubclass("_Session",p);var v={getSession:function(e){var t=c.default.getRESTController(),r=new p;return t.request("GET","sessions/me",{},e).then(function(e){return r._finishFetch(e),r._setExisted(!0),r})}};c.default.setSessionController(v);var y=p;r.default=y},{"./CoreManager":3,"./ParseObject":21,"./ParseUser":29,"./isRevocableSession":43,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/getPrototypeOf":56,"@babel/runtime/helpers/inherits":57,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/possibleConstructorReturn":63,"@babel/runtime/helpers/typeof":67}],29:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var o=n(e("@babel/runtime/helpers/typeof")),i=n(e("@babel/runtime/helpers/classCallCheck")),s=n(e("@babel/runtime/helpers/createClass")),u=n(e("@babel/runtime/helpers/possibleConstructorReturn")),l=n(e("@babel/runtime/helpers/getPrototypeOf")),c=n(e("@babel/runtime/helpers/get")),f=n(e("@babel/runtime/helpers/inherits")),d=n(e("./CoreManager")),h=n(e("./isRevocableSession")),p=n(e("./ParseError")),a=n(e("./ParseObject")),v=n(e("./ParseSession")),y=n(e("./Storage")),b="currentUser",m=!d.default.get("IS_NODE"),g=!1,_=null,w={},P=function(e){function a(e){var t;if((0,i.default)(this,a),t=(0,u.default)(this,(0,l.default)(a).call(this,"_User")),e&&"object"===(0,o.default)(e)&&!t.set(e||{}))throw new Error("Can't create an invalid Parse User");return t}return(0,f.default)(a,e),(0,s.default)(a,[{key:"_upgradeToRevocableSession",value:function(e){var t={};return(e=e||{}).hasOwnProperty("useMasterKey")&&(t.useMasterKey=e.useMasterKey),d.default.getUserController().upgradeToRevocableSession(this,t)}},{key:"_linkWith",value:function(e,t){var r,i=this;if("string"==typeof e?e=w[r=e]:r=e.getAuthType(),t&&t.hasOwnProperty("authData")){var n=this.get("authData")||{};if("object"!==(0,o.default)(n))throw new Error("Invalid type: authData field should be an object");return n[r]=t.authData,d.default.getUserController().linkWith(this,n)}return new Promise(function(n,a){e.authenticate({success:function(e,t){var r={};r.authData=t,i._linkWith(e,r).then(function(){n(i)},function(e){a(e)})},error:function(e,t){a(t)}})})}},{key:"_synchronizeAuthData",value:function(e){if(this.isCurrent()&&e){var t;"string"==typeof e?e=w[t=e]:t=e.getAuthType();var r=this.get("authData");if(e&&r&&"object"===(0,o.default)(r))e.restoreAuthentication(r[t])||this._unlinkFrom(e)}}},{key:"_synchronizeAllAuthData",value:function(){var e=this.get("authData");if("object"===(0,o.default)(e))for(var t in e)this._synchronizeAuthData(t)}},{key:"_cleanupAuthData",value:function(){if(this.isCurrent()){var e=this.get("authData");if("object"===(0,o.default)(e))for(var t in e)e[t]||delete e[t]}}},{key:"_unlinkFrom",value:function(e){var t=this;return"string"==typeof e&&(e=w[e]),this._linkWith(e,{authData:null}).then(function(){return t._synchronizeAuthData(e),Promise.resolve(t)})}},{key:"_isLinked",value:function(e){var t;t="string"==typeof e?e:e.getAuthType();var r=this.get("authData")||{};return"object"===(0,o.default)(r)&&!!r[t]}},{key:"_logOutWithAll",value:function(){var e=this.get("authData");if("object"===(0,o.default)(e))for(var t in e)this._logOutWith(t)}},{key:"_logOutWith",value:function(e){this.isCurrent()&&("string"==typeof e&&(e=w[e]),e&&e.deauthenticate&&e.deauthenticate())}},{key:"_preserveFieldsOnFetch",value:function(){return{sessionToken:this.get("sessionToken")}}},{key:"isCurrent",value:function(){var e=a.current();return!!e&&e.id===this.id}},{key:"getUsername",value:function(){var e=this.get("username");return null==e||"string"==typeof e?e:""}},{key:"setUsername",value:function(e){var t=this.get("authData");t&&"object"===(0,o.default)(t)&&t.hasOwnProperty("anonymous")&&(t.anonymous=null),this.set("username",e)}},{key:"setPassword",value:function(e){this.set("password",e)}},{key:"getEmail",value:function(){var e=this.get("email");return null==e||"string"==typeof e?e:""}},{key:"setEmail",value:function(e){return this.set("email",e)}},{key:"getSessionToken",value:function(){var e=this.get("sessionToken");return null==e||"string"==typeof e?e:""}},{key:"authenticated",value:function(){var e=a.current();return!!this.get("sessionToken")&&!!e&&e.id===this.id}},{key:"signUp",value:function(e,t){var r={};return(t=t||{}).hasOwnProperty("useMasterKey")&&(r.useMasterKey=t.useMasterKey),t.hasOwnProperty("installationId")&&(r.installationId=t.installationId),d.default.getUserController().signUp(this,e,r)}},{key:"logIn",value:function(e){var t={};return(e=e||{}).hasOwnProperty("useMasterKey")&&(t.useMasterKey=e.useMasterKey),e.hasOwnProperty("installationId")&&(t.installationId=e.installationId),d.default.getUserController().logIn(this,t)}},{key:"save",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(0,c.default)((0,l.default)(a.prototype),"save",this).apply(this,r).then(function(){return e.isCurrent()?d.default.getUserController().updateUserOnDisk(e):e})}},{key:"destroy",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(0,c.default)((0,l.default)(a.prototype),"destroy",this).apply(this,r).then(function(){return e.isCurrent()?d.default.getUserController().removeUserFromDisk():e})}},{key:"fetch",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(0,c.default)((0,l.default)(a.prototype),"fetch",this).apply(this,r).then(function(){return e.isCurrent()?d.default.getUserController().updateUserOnDisk(e):e})}},{key:"fetchWithInclude",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(0,c.default)((0,l.default)(a.prototype),"fetchWithInclude",this).apply(this,r).then(function(){return e.isCurrent()?d.default.getUserController().updateUserOnDisk(e):e})}}],[{key:"readOnlyAttributes",value:function(){return["sessionToken"]}},{key:"extend",value:function(e,t){if(e)for(var r in e)"className"!==r&&Object.defineProperty(a.prototype,r,{value:e[r],enumerable:!1,writable:!0,configurable:!0});if(t)for(var n in t)"className"!==n&&Object.defineProperty(a,n,{value:t[n],enumerable:!1,writable:!0,configurable:!0});return a}},{key:"current",value:function(){return m?d.default.getUserController().currentUser():null}},{key:"currentAsync",value:function(){return m?d.default.getUserController().currentUserAsync():Promise.resolve(null)}},{key:"signUp",value:function(e,t,r,n){return(r=r||{}).username=e,r.password=t,new a(r).signUp({},n)}},{key:"logIn",value:function(e,t,r){if("string"!=typeof e)return Promise.reject(new p.default(p.default.OTHER_CAUSE,"Username must be a string."));if("string"!=typeof t)return Promise.reject(new p.default(p.default.OTHER_CAUSE,"Password must be a string."));var n=new a;return n._finishFetch({username:e,password:t}),n.logIn(r)}},{key:"become",value:function(e,t){if(!m)throw new Error("It is not memory-safe to become a user in a server environment");var r={sessionToken:e};return(t=t||{}).hasOwnProperty("useMasterKey")&&(r.useMasterKey=t.useMasterKey),d.default.getUserController().become(r)}},{key:"hydrate",value:function(e){return d.default.getUserController().hydrate(e)}},{key:"logInWith",value:function(e,t){return a._logInWith(e,t)}},{key:"logOut",value:function(){if(!m)throw new Error("There is no current user on a node.js server environment.");return d.default.getUserController().logOut()}},{key:"requestPasswordReset",value:function(e,t){var r={};return(t=t||{}).hasOwnProperty("useMasterKey")&&(r.useMasterKey=t.useMasterKey),d.default.getUserController().requestPasswordReset(e,r)}},{key:"allowCustomUserClass",value:function(e){d.default.set("PERFORM_USER_REWRITE",!e)}},{key:"enableRevocableSession",value:function(e){if(e=e||{},d.default.set("FORCE_REVOCABLE_SESSION",!0),m){var t=a.current();if(t)return t._upgradeToRevocableSession(e)}return Promise.resolve()}},{key:"enableUnsafeCurrentUser",value:function(){m=!0}},{key:"disableUnsafeCurrentUser",value:function(){m=!1}},{key:"_registerAuthenticationProvider",value:function(t){w[t.getAuthType()]=t,a.currentAsync().then(function(e){e&&e._synchronizeAuthData(t.getAuthType())})}},{key:"_logInWith",value:function(e,t){return(new a)._linkWith(e,t)}},{key:"_clearCache",value:function(){_=null,g=!1}},{key:"_setCurrentUserCache",value:function(e){_=e}}]),a}(a.default);a.default.registerSubclass("_User",P);var O={updateUserOnDisk:function(e){var t=y.default.generatePath(b),r=e.toJSON();return r.className="_User",y.default.setItemAsync(t,JSON.stringify(r)).then(function(){return e})},removeUserFromDisk:function(){var e=y.default.generatePath(b);return g=!0,_=null,y.default.removeItemAsync(e)},setCurrentUser:function(e){return(_=e)._cleanupAuthData(),e._synchronizeAllAuthData(),O.updateUserOnDisk(e)},currentUser:function(){if(_)return _;if(g)return null;if(y.default.async())throw new Error("Cannot call currentUser() when using a platform with an async storage system. Call currentUserAsync() instead.");var e=y.default.generatePath(b),t=y.default.getItem(e);if(g=!0,!t)return _=null;(t=JSON.parse(t)).className||(t.className="_User"),t._id&&(t.objectId!==t._id&&(t.objectId=t._id),delete t._id),t._sessionToken&&(t.sessionToken=t._sessionToken,delete t._sessionToken);var r=a.default.fromJSON(t);return(_=r)._synchronizeAllAuthData(),r},currentUserAsync:function(){if(_)return Promise.resolve(_);if(g)return Promise.resolve(null);var e=y.default.generatePath(b);return y.default.getItemAsync(e).then(function(e){if(g=!0,!e)return _=null,Promise.resolve(null);(e=JSON.parse(e)).className||(e.className="_User"),e._id&&(e.objectId!==e._id&&(e.objectId=e._id),delete e._id),e._sessionToken&&(e.sessionToken=e._sessionToken,delete e._sessionToken);var t=a.default.fromJSON(e);return(_=t)._synchronizeAllAuthData(),Promise.resolve(t)})},signUp:function(e,t,r){var n=t&&t.username||e.get("username"),a=t&&t.password||e.get("password");return n&&n.length?a&&a.length?e.save(t,r).then(function(){return e._finishFetch({password:void 0}),m?O.setCurrentUser(e):e}):Promise.reject(new p.default(p.default.OTHER_CAUSE,"Cannot sign up user with an empty password.")):Promise.reject(new p.default(p.default.OTHER_CAUSE,"Cannot sign up user with an empty name."))},logIn:function(t,e){var r=d.default.getRESTController(),n=d.default.getObjectStateController(),a={username:t.get("username"),password:t.get("password")};return r.request("GET","login",a,e).then(function(e){return t._migrateId(e.objectId),t._setExisted(!0),n.setPendingOp(t._getStateIdentifier(),"username",void 0),n.setPendingOp(t._getStateIdentifier(),"password",void 0),e.password=void 0,t._finishFetch(e),m?O.setCurrentUser(t):Promise.resolve(t)})},become:function(e){var t=new P;return d.default.getRESTController().request("GET","users/me",{},e).then(function(e){return t._finishFetch(e),t._setExisted(!0),O.setCurrentUser(t)})},hydrate:function(e){var t=new P;return t._finishFetch(e),t._setExisted(!0),e.sessionToken&&m?O.setCurrentUser(t):Promise.resolve(t)},logOut:function(){return O.currentUserAsync().then(function(e){var t=y.default.generatePath(b),r=y.default.removeItemAsync(t),n=d.default.getRESTController();if(null!==e){var a=e.getSessionToken();a&&(0,h.default)(a)&&(r=r.then(function(){return n.request("POST","logout",{},{sessionToken:a})})),e._logOutWithAll(),e._finishFetch({sessionToken:void 0})}return g=!0,_=null,r})},requestPasswordReset:function(e,t){return d.default.getRESTController().request("POST","requestPasswordReset",{email:e},t)},upgradeToRevocableSession:function(r,e){var t=r.getSessionToken();return t?(e.sessionToken=t,d.default.getRESTController().request("POST","upgradeToRevocableSession",{},e).then(function(e){var t=new v.default;return t._finishFetch(e),r._finishFetch({sessionToken:t.getSessionToken()}),r.isCurrent()?O.setCurrentUser(r):Promise.resolve(r)})):Promise.reject(new p.default(p.default.SESSION_MISSING,"Cannot upgrade a user with no session token"))},linkWith:function(e,t){return e.save({authData:t}).then(function(){return m?O.setCurrentUser(e):e})}};d.default.setUserController(O);var k=P;r.default=k},{"./CoreManager":3,"./ParseError":16,"./ParseObject":21,"./ParseSession":28,"./Storage":33,"./isRevocableSession":43,"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/get":55,"@babel/runtime/helpers/getPrototypeOf":56,"@babel/runtime/helpers/inherits":57,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/possibleConstructorReturn":63,"@babel/runtime/helpers/typeof":67}],30:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.send=function(e,t){t=t||{},e.where&&e.where instanceof o.default&&(e.where=e.where.toJSON().where);e.push_time&&"object"===(0,a.default)(e.push_time)&&(e.push_time=e.push_time.toJSON());e.expiration_time&&"object"===(0,a.default)(e.expiration_time)&&(e.expiration_time=e.expiration_time.toJSON());if(e.expiration_time&&e.expiration_interval)throw new Error("expiration_time and expiration_interval cannot both be set.");return i.default.getPushController().send(e,{useMasterKey:t.useMasterKey})};var a=n(e("@babel/runtime/helpers/typeof")),i=n(e("./CoreManager")),o=n(e("./ParseQuery"));var s={send:function(e,t){return i.default.getRESTController().request("POST","push",e,{useMasterKey:!!t.useMasterKey})}};i.default.setPushController(s)},{"./CoreManager":3,"./ParseQuery":24,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],31:[function(t,r,e){(function(h){"use strict";var e=t("@babel/runtime/helpers/interopRequireDefault"),f=e(t("@babel/runtime/helpers/typeof")),p=e(t("./CoreManager")),v=e(t("./ParseError")),y=null;"undefined"!=typeof XMLHttpRequest&&(y=XMLHttpRequest);var b=!1;"undefined"==typeof XDomainRequest||"withCredentials"in new XMLHttpRequest||(b=!0);var d={ajax:function(t,i,o,s,u){if(b)return e=t,a=i,l=o,c=s,new Promise(function(t,r){var n=new XDomainRequest;n.onload=function(){var e;try{e=JSON.parse(n.responseText)}catch(e){r(e)}e&&t({response:e})},n.onerror=n.ontimeout=function(){var e={responseText:JSON.stringify({code:v.default.X_DOMAIN_REQUEST,error:"IE's XDomainRequest does not supply error info."})};r(e)},n.onprogress=function(){c&&"function"==typeof c.progress&&c.progress(n.responseText)},n.open(e,a),n.send(l)});var e,a,l,c,r,n,f=new Promise(function(e,t){r=e,n=t});f.resolve=r,f.reject=n;var d=0;return function r(){if(null==y)throw new Error("Cannot make a request: No definition of XMLHttpRequest was found.");var n=!1,a=new y;for(var e in a.onreadystatechange=function(){if(4===a.readyState&&!n)if(n=!0,200<=a.status&&a.status<300){var e;try{e=JSON.parse(a.responseText),"function"==typeof a.getResponseHeader&&(a.getAllResponseHeaders()||"").includes("x-parse-job-status-id: ")&&(e=a.getResponseHeader("x-parse-job-status-id"))}catch(e){f.reject(e.toString())}e&&f.resolve({response:e,status:a.status,xhr:a})}else if(500<=a.status||0===a.status)if(++d<p.default.get("REQUEST_ATTEMPT_LIMIT")){var t=Math.round(125*Math.random()*Math.pow(2,d));setTimeout(r,t)}else 0===a.status?f.reject("Unable to connect to the Parse API"):f.reject(a);else f.reject(a)},"string"!=typeof(s=s||{})["Content-Type"]&&(s["Content-Type"]="text/plain"),p.default.get("IS_NODE")&&(s["User-Agent"]="Parse/"+p.default.get("VERSION")+" (NodeJS "+h.versions.node+")"),u&&"function"==typeof u.progress&&(a.upload?a.upload.addEventListener("progress",function(e){e.lengthComputable?u.progress(e.loaded/e.total):u.progress(null)}):a.addEventListener&&a.addEventListener("progress",function(e){e.lengthComputable?u.progress(e.loaded/e.total):u.progress(null)})),a.open(t,i,!0),s)a.setRequestHeader(e,s[e]);a.send(o)}(),f},request:function(r,e,t,n){n=n||{};var a=p.default.get("SERVER_URL");"/"!==a[a.length-1]&&(a+="/"),a+=e;var i={};if(t&&"object"===(0,f.default)(t))for(var o in t)i[o]=t[o];"POST"!==r&&(i._method=r,r="POST"),i._ApplicationId=p.default.get("APPLICATION_ID");var s=p.default.get("JAVASCRIPT_KEY");s&&(i._JavaScriptKey=s),i._ClientVersion=p.default.get("VERSION");var u=n.useMasterKey;if(void 0===u&&(u=p.default.get("USE_MASTER_KEY")),u){if(!p.default.get("MASTER_KEY"))throw new Error("Cannot use the Master Key, it has not been provided.");delete i._JavaScriptKey,i._MasterKey=p.default.get("MASTER_KEY")}p.default.get("FORCE_REVOCABLE_SESSION")&&(i._RevocableSession="1");var l,c=n.installationId;c&&"string"==typeof c?l=Promise.resolve(c):l=p.default.getInstallationController().currentInstallationId();return l.then(function(e){i._InstallationId=e;var t=p.default.getUserController();return n&&"string"==typeof n.sessionToken?Promise.resolve(n.sessionToken):t?t.currentUserAsync().then(function(e){return e?Promise.resolve(e.getSessionToken()):Promise.resolve(null)}):Promise.resolve(null)}).then(function(e){e&&(i._SessionToken=e);var t=JSON.stringify(i);return d.ajax(r,a,t,{},n).then(function(e){return e.response})}).catch(function(t){var r;if(t&&t.responseText)try{var e=JSON.parse(t.responseText);r=new v.default(e.code,e.error)}catch(e){r=new v.default(v.default.INVALID_JSON,"Received an error with invalid JSON from Parse: "+t.responseText)}else r=new v.default(v.default.CONNECTION_FAILED,"XMLHttpRequest failed: "+JSON.stringify(t));return Promise.reject(r)})},_setXHR:function(e){y=e}};r.exports=d}).call(this,t("_process"))},{"./CoreManager":3,"./ParseError":16,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67,_process:70}],32:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(r,"__esModule",{value:!0}),r.getState=o,r.initializeState=s,r.removeState=function(e){var t=o(e);return null!==t?(delete i[e.className][e.id],t):null},r.getServerData=u,r.setServerData=function(e,t){var r=s(e).serverData;a.setServerData(r,t)},r.getPendingOps=l,r.setPendingOp=function(e,t,r){var n=s(e).pendingOps;a.setPendingOp(n,t,r)},r.pushPendingState=function(e){var t=s(e).pendingOps;a.pushPendingState(t)},r.popPendingState=function(e){var t=s(e).pendingOps;return a.popPendingState(t)},r.mergeFirstPendingState=function(e){var t=l(e);a.mergeFirstPendingState(t)},r.getObjectCache=function(e){var t=o(e);if(t)return t.objectCache;return{}},r.estimateAttribute=function(e,t){var r=u(e),n=l(e);return a.estimateAttribute(r,n,e.className,e.id,t)},r.estimateAttributes=function(e){var t=u(e),r=l(e);return a.estimateAttributes(t,r,e.className,e.id)},r.commitServerChanges=function(e,t){var r=s(e);a.commitServerChanges(r.serverData,r.objectCache,t)},r.enqueueTask=function(e,t){return s(e).tasks.enqueue(t)},r.clearAllState=function(){i={}},r.duplicateState=function(e,t){t.id=e.id};var a=n(e("./ObjectStateMutations")),i={};function o(e){var t=i[e.className];return t&&t[e.id]||null}function s(e,t){var r=o(e);return r||(i[e.className]||(i[e.className]={}),t||(t=a.defaultState()),r=i[e.className][e.id]=t)}function u(e){var t=o(e);return t?t.serverData:{}}function l(e){var t=o(e);return t?t.pendingOps:[{}]}},{"./ObjectStateMutations":11,"@babel/runtime/helpers/interopRequireWildcard":59}],33:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault")(e("./CoreManager")),a={async:function(){return!!n.default.getStorageController().async},getItem:function(e){var t=n.default.getStorageController();if(1===t.async)throw new Error("Synchronous storage is not supported by the current storage controller");return t.getItem(e)},getItemAsync:function(e){var t=n.default.getStorageController();return 1===t.async?t.getItemAsync(e):Promise.resolve(t.getItem(e))},setItem:function(e,t){var r=n.default.getStorageController();if(1===r.async)throw new Error("Synchronous storage is not supported by the current storage controller");return r.setItem(e,t)},setItemAsync:function(e,t){var r=n.default.getStorageController();return 1===r.async?r.setItemAsync(e,t):Promise.resolve(r.setItem(e,t))},removeItem:function(e){var t=n.default.getStorageController();if(1===t.async)throw new Error("Synchronous storage is not supported by the current storage controller");return t.removeItem(e)},removeItemAsync:function(e){var t=n.default.getStorageController();return 1===t.async?t.removeItemAsync(e):Promise.resolve(t.removeItem(e))},generatePath:function(e){if(!n.default.get("APPLICATION_ID"))throw new Error("You need to call Parse.initialize before using Parse.");if("string"!=typeof e)throw new Error("Tried to get a Storage path that was not a String.");return"/"===e[0]&&(e=e.substr(1)),"Parse/"+n.default.get("APPLICATION_ID")+"/"+e},_clear:function(){var e=n.default.getStorageController();e.hasOwnProperty("clear")&&e.clear()}};t.exports=a,n.default.setStorageController(e("./StorageController.browser"))},{"./CoreManager":3,"./StorageController.browser":34,"@babel/runtime/helpers/interopRequireDefault":58}],34:[function(e,t,r){"use strict";var n={async:0,getItem:function(e){return localStorage.getItem(e)},setItem:function(e,t){try{localStorage.setItem(e,t)}catch(e){}},removeItem:function(e){localStorage.removeItem(e)},clear:function(){localStorage.clear()}};t.exports=n},{}],35:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault"),a=n(e("@babel/runtime/helpers/classCallCheck")),i=n(e("@babel/runtime/helpers/createClass")),o=n(e("@babel/runtime/helpers/defineProperty")),s=function(){function e(){(0,a.default)(this,e),(0,o.default)(this,"queue",void 0),this.queue=[]}return(0,i.default)(e,[{key:"enqueue",value:function(e){var r,n,t=this,a=new Promise(function(e,t){r=e,n=t});return a.resolve=r,a.reject=n,this.queue.push({task:e,_completion:a}),1===this.queue.length&&e().then(function(){t._dequeue(),a.resolve()},function(e){t._dequeue(),a.reject(e)}),a}},{key:"_dequeue",value:function(){var t=this;if(this.queue.shift(),this.queue.length){var r=this.queue[0];r.task().then(function(){t._dequeue(),r._completion.resolve()},function(e){t._dequeue(),r._completion.reject(e)})}}}]),e}();t.exports=s},{"@babel/runtime/helpers/classCallCheck":51,"@babel/runtime/helpers/createClass":53,"@babel/runtime/helpers/defineProperty":54,"@babel/runtime/helpers/interopRequireDefault":58}],36:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/interopRequireWildcard");Object.defineProperty(r,"__esModule",{value:!0}),r.getState=u,r.initializeState=l,r.removeState=function(e){var t=u(e);return null!==t?(s.delete(e),t):null},r.getServerData=c,r.setServerData=function(e,t){var r=l(e).serverData;i.setServerData(r,t)},r.getPendingOps=f,r.setPendingOp=function(e,t,r){var n=l(e).pendingOps;i.setPendingOp(n,t,r)},r.pushPendingState=function(e){var t=l(e).pendingOps;i.pushPendingState(t)},r.popPendingState=function(e){var t=l(e).pendingOps;return i.popPendingState(t)},r.mergeFirstPendingState=function(e){var t=f(e);i.mergeFirstPendingState(t)},r.getObjectCache=function(e){var t=u(e);if(t)return t.objectCache;return{}},r.estimateAttribute=function(e,t){var r=c(e),n=f(e);return i.estimateAttribute(r,n,e.className,e.id,t)},r.estimateAttributes=function(e){var t=c(e),r=f(e);return i.estimateAttributes(t,r,e.className,e.id)},r.commitServerChanges=function(e,t){var r=l(e);i.commitServerChanges(r.serverData,r.objectCache,t)},r.enqueueTask=function(e,t){return l(e).tasks.enqueue(t)},r.duplicateState=function(e,t){var r=l(e),n=l(t);for(var a in r.serverData)n.serverData[a]=r.serverData[a];for(var i=0;i<r.pendingOps.length;i++)for(var o in r.pendingOps[i])n.pendingOps[i][o]=r.pendingOps[i][o];for(var s in r.objectCache)n.objectCache[s]=r.objectCache[s];n.existed=r.existed},r.clearAllState=function(){s=new WeakMap};var i=a(e("./ObjectStateMutations")),o=n(e("./TaskQueue")),s=new WeakMap;function u(e){return s.get(e)||null}function l(e,t){var r=u(e);return r||(t||(t={serverData:{},pendingOps:[{}],objectCache:{},tasks:new o.default,existed:!1}),r=t,s.set(e,r),r)}function c(e){var t=u(e);return t?t.serverData:{}}function f(e){var t=u(e);return t?t.pendingOps:[{}]}},{"./ObjectStateMutations":11,"./TaskQueue":35,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/interopRequireWildcard":59}],37:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){if(-1<e.indexOf(t))return!0;for(var r=0;r<e.length;r++)if(e[r]instanceof a.default&&e[r].className===t.className&&e[r]._getId()===t._getId())return!0;return!1};var a=n(e("./ParseObject"))},{"./ParseObject":21,"@babel/runtime/helpers/interopRequireDefault":58}],38:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){if(!(e instanceof o.default))return!0;var t=e.attributes;for(var r in t){var n=t[r];if(!u(n))return!1}return!0};var a=n(e("@babel/runtime/helpers/typeof")),i=n(e("./ParseFile")),o=n(e("./ParseObject")),s=n(e("./ParseRelation"));function u(e){if("object"!==(0,a.default)(e))return!0;if(e instanceof s.default)return!0;if(e instanceof o.default)return!!e.id;if(e instanceof i.default)return!!e.url();if(Array.isArray(e)){for(var t=0;t<e.length;t++)if(!u(e[t]))return!1;return!0}for(var r in e)if(!u(e[r]))return!1;return!0}},{"./ParseFile":17,"./ParseObject":21,"./ParseRelation":25,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],39:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function r(e){if(null===e||"object"!==(0,o.default)(e))return e;if(Array.isArray(e)){var n=[];return e.forEach(function(e,t){n[t]=r(e)}),n}if("string"==typeof e.__op)return(0,f.opFromJSON)(e);if("Pointer"===e.__type&&e.className)return c.default.fromJSON(e);if("Object"===e.__type&&e.className)return c.default.fromJSON(e);if("Relation"===e.__type){var t=new d.default(null,null);return t.targetClassName=e.className,t}if("Date"===e.__type)return new Date(e.iso);if("File"===e.__type)return s.default.fromJSON(e);if("GeoPoint"===e.__type)return new u.default({latitude:e.latitude,longitude:e.longitude});if("Polygon"===e.__type)return new l.default(e.coordinates);var a={};for(var i in e)a[i]=r(e[i]);return a};var o=n(e("@babel/runtime/helpers/typeof")),s=(n(e("./ParseACL")),n(e("./ParseFile"))),u=n(e("./ParseGeoPoint")),l=n(e("./ParsePolygon")),c=n(e("./ParseObject")),f=e("./ParseOp"),d=n(e("./ParseRelation"))},{"./ParseACL":14,"./ParseFile":17,"./ParseGeoPoint":18,"./ParseObject":21,"./ParseOp":22,"./ParsePolygon":23,"./ParseRelation":25,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],40:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t,r,n){return function t(e,r,n,a){if(e instanceof h.default){if(r)throw new Error("Parse Objects not allowed here");var i=e.id?e.className+":"+e.id:e;return n||!a||-1<a.indexOf(i)||e.dirty()||Object.keys(e._getServerData()).length<1?e.toPointer():(a=a.concat(i),e._toFullJSON(a))}if(e instanceof p.Op||e instanceof l.default||e instanceof f.default||e instanceof d.default||e instanceof v.default)return e.toJSON();if(e instanceof c.default){if(!e.url())throw new Error("Tried to encode an unsaved file.");return e.toJSON()}if("[object Date]"===y.call(e)){if(isNaN(e))throw new Error("Tried to encode an invalid date.");return{__type:"Date",iso:e.toJSON()}}if("[object RegExp]"===y.call(e)&&"string"==typeof e.source)return e.source;if(Array.isArray(e))return e.map(function(e){return t(e,r,n,a)});if(e&&"object"===(0,u.default)(e)){var o={};for(var s in e)o[s]=t(e[s],r,n,a);return o}return e}(e,!!t,!!r,n||[])};var u=n(e("@babel/runtime/helpers/typeof")),l=n(e("./ParseACL")),c=n(e("./ParseFile")),f=n(e("./ParseGeoPoint")),d=n(e("./ParsePolygon")),h=n(e("./ParseObject")),p=e("./ParseOp"),v=n(e("./ParseRelation")),y=Object.prototype.toString},{"./ParseACL":14,"./ParseFile":17,"./ParseGeoPoint":18,"./ParseObject":21,"./ParseOp":22,"./ParsePolygon":23,"./ParseRelation":25,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],41:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function e(t,r){if("[object Date]"===d.call(t)||"[object Date]"===d.call(r)){var n=new Date(t),a=new Date(r);return+n==+a}if((0,s.default)(t)!==(0,s.default)(r))return!1;if(!t||"object"!==(0,s.default)(t))return t===r;if(Array.isArray(t)||Array.isArray(r)){if(!Array.isArray(t)||!Array.isArray(r))return!1;if(t.length!==r.length)return!1;for(var i=t.length;i--;)if(!e(t[i],r[i]))return!1;return!0}if(t instanceof u.default||t instanceof l.default||t instanceof c.default||t instanceof f.default)return t.equals(r);if(r instanceof f.default&&("Object"===t.__type||"Pointer"===t.__type))return t.objectId===r.id&&t.className===r.className;if(Object.keys(t).length!==Object.keys(r).length)return!1;for(var o in t)if(!e(t[o],r[o]))return!1;return!0};var s=n(e("@babel/runtime/helpers/typeof")),u=n(e("./ParseACL")),l=n(e("./ParseFile")),c=n(e("./ParseGeoPoint")),f=n(e("./ParseObject")),d=Object.prototype.toString},{"./ParseACL":14,"./ParseFile":17,"./ParseGeoPoint":18,"./ParseObject":21,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return e.replace(/[&<>\/'"]/g,function(e){return n[e]})};var n={"&":"&amp;","<":"&lt;",">":"&gt;","/":"&#x2F;","'":"&#x27;",'"':"&quot;"}},{}],43:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){return-1<e.indexOf("r:")}},{}],44:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){var t=new RegExp("^([0-9]{1,4})-([0-9]{1,2})-([0-9]{1,2})T([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(.([0-9]+))?Z$").exec(e);if(!t)return null;var r=t[1]||0,n=(t[2]||1)-1,a=t[3]||0,i=t[4]||0,o=t[5]||0,s=t[6]||0,u=t[8]||0;return new Date(Date.UTC(r,n,a,i,o,s,u))}},{}],45:[function(e,t,r){"use strict";function d(){var r,n,e=new Promise(function(e,t){r=e,n=t});return e.resolve=r,e.reject=n,e}Object.defineProperty(r,"__esModule",{value:!0}),r.resolvingPromise=d,r.when=function(e){var t,r=Array.isArray(e);t=r?e:arguments;var n=t.length,a=!1,i=[],o=r?[i]:i,s=[];if(i.length=t.length,s.length=t.length,0===n)return Promise.resolve(o);for(var u=new d,l=function(){--n<=0&&(a?u.reject(s):u.resolve(o))},c=function(e,t){e&&"function"==typeof e.then?e.then(function(e){i[t]=e,l()},function(e){s[t]=e,a=!0,l()}):(i[t]=e,l())},f=0;f<t.length;f++)c(t[f],f);return u},r.continueWhile=function e(t,r){if(t())return r().then(function(){return e(t,r)});return Promise.resolve()}},{}],46:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e){var t=[];return e.forEach(function(e){e instanceof i.default?(0,a.default)(t,e)||t.push(e):t.indexOf(e)<0&&t.push(e)}),t};var a=n(e("./arrayContainsObject")),i=n(e("./ParseObject"))},{"./ParseObject":21,"./arrayContainsObject":37,"@babel/runtime/helpers/interopRequireDefault":58}],47:[function(e,t,r){"use strict";var n=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(e,t){var r={objects:{},files:[]},n=e.className+":"+e._getId();r.objects[n]=!e.dirty()||e;var a=e.attributes;for(var i in a)"object"===(0,u.default)(a[i])&&d(a[i],r,!1,!!t);var o=[];for(var s in r.objects)s!==n&&!0!==r.objects[s]&&o.push(r.objects[s]);return o.concat(r.files)};var u=n(e("@babel/runtime/helpers/typeof")),l=n(e("./ParseFile")),c=n(e("./ParseObject")),f=n(e("./ParseRelation"));function d(e,t,r,n){if(e instanceof c.default){if(!e.id&&r)throw new Error("Cannot create a pointer to an unsaved Object.");var a=e.className+":"+e._getId();if(!t.objects[a]){t.objects[a]=!e.dirty()||e;var i=e.attributes;for(var o in i)"object"===(0,u.default)(i[o])&&d(i[o],t,!n,n)}}else if(e instanceof l.default)!e.url()&&t.files.indexOf(e)<0&&t.files.push(e);else if(!(e instanceof f.default))for(var s in Array.isArray(e)&&e.forEach(function(e){"object"===(0,u.default)(e)&&d(e,t,r,n)}),e)"object"===(0,u.default)(e[s])&&d(e[s],t,r,n)}},{"./ParseFile":17,"./ParseObject":21,"./ParseRelation":25,"@babel/runtime/helpers/interopRequireDefault":58,"@babel/runtime/helpers/typeof":67}],48:[function(e,t,r){t.exports=function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}},{}],49:[function(e,t,r){t.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},{}],50:[function(e,t,r){function u(e,t,r,n,a,i,o){try{var s=e[i](o),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}t.exports=function(s){return function(){var e=this,o=arguments;return new Promise(function(t,r){var n=s.apply(e,o);function a(e){u(n,t,r,a,i,"next",e)}function i(e){u(n,t,r,a,i,"throw",e)}a(void 0)})}}},{}],51:[function(e,t,r){t.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},{}],52:[function(e,n,t){var i=e("./setPrototypeOf");function a(e,t,r){return!function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?n.exports=a=function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&i(a,r.prototype),a}:n.exports=a=Reflect.construct,a.apply(null,arguments)}n.exports=a},{"./setPrototypeOf":64}],53:[function(e,t,r){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}t.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},{}],54:[function(e,t,r){t.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},{}],55:[function(e,n,t){e("./getPrototypeOf");var i=e("./superPropBase");function a(e,t,r){return"undefined"!=typeof Reflect&&Reflect.get?n.exports=a=Reflect.get:n.exports=a=function(e,t,r){var n=i(e,t);if(n){var a=Object.getOwnPropertyDescriptor(n,t);return a.get?a.get.call(r):a.value}},a(e,t,r||e)}n.exports=a},{"./getPrototypeOf":56,"./superPropBase":65}],56:[function(e,t,r){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}t.exports=n},{}],57:[function(e,t,r){var n=e("./setPrototypeOf");t.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},{"./setPrototypeOf":64}],58:[function(e,t,r){t.exports=function(e){return e&&e.__esModule?e:{default:e}}},{}],59:[function(e,t,r){t.exports=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(e,r):{};n.get||n.set?Object.defineProperty(t,r,n):t[r]=e[r]}return t.default=e,t}},{}],60:[function(e,t,r){t.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}},{}],61:[function(e,t,r){t.exports=function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}},{}],62:[function(e,t,r){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}},{}],63:[function(e,t,r){var n=e("../helpers/typeof"),a=e("./assertThisInitialized");t.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?a(e):t}},{"../helpers/typeof":67,"./assertThisInitialized":49}],64:[function(e,r,t){function n(e,t){return r.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}r.exports=n},{}],65:[function(e,t,r){var n=e("./getPrototypeOf");t.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}},{"./getPrototypeOf":56}],66:[function(e,t,r){var n=e("./arrayWithoutHoles"),a=e("./iterableToArray"),i=e("./nonIterableSpread");t.exports=function(e){return n(e)||a(e)||i()}},{"./arrayWithoutHoles":48,"./iterableToArray":61,"./nonIterableSpread":62}],67:[function(e,t,r){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return"function"==typeof Symbol&&"symbol"===n(Symbol.iterator)?t.exports=a=function(e){return n(e)}:t.exports=a=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":n(e)},a(e)}t.exports=a},{}],68:[function(e,t,r){var n=e("./getPrototypeOf"),a=e("./setPrototypeOf"),i=e("./isNativeFunction"),o=e("./construct");function s(e){var r="function"==typeof Map?new Map:void 0;return t.exports=s=function(e){if(null===e||!i(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return o(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),a(t,e)},s(e)}t.exports=s},{"./construct":52,"./getPrototypeOf":56,"./isNativeFunction":60,"./setPrototypeOf":64}],69:[function(e,t,r){t.exports=e("regenerator-runtime")},{"regenerator-runtime":72}],70:[function(e,t,r){},{}],71:[function(e,t,r){var u=Object.create||function(e){var t=function(){};return t.prototype=e,new t},o=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return r},i=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function n(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=u(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}((t.exports=n).EventEmitter=n).prototype._events=void 0,n.prototype._maxListeners=void 0;var a,s=10;try{var l={};Object.defineProperty&&Object.defineProperty(l,"x",{value:0}),a=0===l.x}catch(e){a=!1}function c(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function f(e,t,r,n){var a,i,o;if("function"!=typeof r)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),o=i[t]):(i=e._events=u(null),e._eventsCount=0),o){if("function"==typeof o?o=i[t]=n?[r,o]:[o,r]:n?o.unshift(r):o.push(r),!o.warned&&(a=c(e))&&0<a&&o.length>a){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",s.name,s.message)}}else o=i[t]=r,++e._eventsCount;return e}function d(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},a=i.call(d,n);return a.listener=r,n.wrapFn=a}function p(e,t,r){var n=e._events;if(!n)return[];var a=n[t];return a?"function"==typeof a?r?[a.listener||a]:[a]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(a):y(a,a.length):[]}function v(e){var t=this._events;if(t){var r=t[e];if("function"==typeof r)return 1;if(r)return r.length}return 0}function y(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}a?Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');s=e}}):n.defaultMaxListeners=s,n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return c(this)},n.prototype.emit=function(e){var t,r,n,a,i,o,s="error"===e;if(o=this._events)s=s&&null==o.error;else if(!s)return!1;if(s){if(1<arguments.length&&(t=arguments[1]),t instanceof Error)throw t;var u=new Error('Unhandled "error" event. ('+t+")");throw u.context=t,u}if(!(r=o[e]))return!1;var l="function"==typeof r;switch(n=arguments.length){case 1:!function(e,t,r){if(t)e.call(r);else for(var n=e.length,a=y(e,n),i=0;i<n;++i)a[i].call(r)}(r,l,this);break;case 2:!function(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=y(e,a),o=0;o<a;++o)i[o].call(r,n)}(r,l,this,arguments[1]);break;case 3:!function(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,o=y(e,i),s=0;s<i;++s)o[s].call(r,n,a)}(r,l,this,arguments[1],arguments[2]);break;case 4:!function(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var o=e.length,s=y(e,o),u=0;u<o;++u)s[u].call(r,n,a,i)}(r,l,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(n-1),i=1;i<n;i++)a[i-1]=arguments[i];!function(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=y(e,a),o=0;o<a;++o)i[o].apply(r,n)}(r,l,this,a)}return!0},n.prototype.on=n.prototype.addListener=function(e,t){return f(this,e,t,!1)},n.prototype.prependListener=function(e,t){return f(this,e,t,!0)},n.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,h(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,h(this,e,t)),this},n.prototype.removeListener=function(e,t){var r,n,a,i,o;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(n=this._events))return this;if(!(r=n[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=u(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(a=-1,i=r.length-1;0<=i;i--)if(r[i]===t||r[i].listener===t){o=r[i].listener,a=i;break}if(a<0)return this;0===a?r.shift():function(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}(r,a),1===r.length&&(n[e]=r[0]),n.removeListener&&this.emit("removeListener",e,o||t)}return this},n.prototype.removeAllListeners=function(e){var t,r,n;if(!(r=this._events))return this;if(!r.removeListener)return 0===arguments.length?(this._events=u(null),this._eventsCount=0):r[e]&&(0==--this._eventsCount?this._events=u(null):delete r[e]),this;if(0===arguments.length){var a,i=o(r);for(n=0;n<i.length;++n)"removeListener"!==(a=i[n])&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=u(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(t)for(n=t.length-1;0<=n;n--)this.removeListener(e,t[n]);return this},n.prototype.listeners=function(e){return p(this,e,!0)},n.prototype.rawListeners=function(e){return p(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},n.prototype.listenerCount=v,n.prototype.eventNames=function(){return 0<this._eventsCount?Reflect.ownKeys(this._events):[]}},{}],72:[function(e,t,r){var n=function(){return this||"object"==typeof self&&self}()||Function("return this")(),a=n.regeneratorRuntime&&0<=Object.getOwnPropertyNames(n).indexOf("regeneratorRuntime"),i=a&&n.regeneratorRuntime;if(n.regeneratorRuntime=void 0,t.exports=e("./runtime"),a)n.regeneratorRuntime=i;else try{delete n.regeneratorRuntime}catch(e){n.regeneratorRuntime=void 0}},{"./runtime":73}],73:[function(e,T,t){!function(e){"use strict";var u,t=Object.prototype,l=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",n=r.asyncIterator||"@@asyncIterator",i=r.toStringTag||"@@toStringTag",o="object"==typeof T,s=e.regeneratorRuntime;if(s)o&&(T.exports=s);else{(s=e.regeneratorRuntime=o?T.exports:{}).wrap=g;var f="suspendedStart",d="suspendedYield",h="executing",p="completed",v={},c={};c[a]=function(){return this};var y=Object.getPrototypeOf,b=y&&y(y(I([])));b&&b!==t&&l.call(b,a)&&(c=b);var m=O.prototype=w.prototype=Object.create(c);P.prototype=m.constructor=O,O.constructor=P,O[i]=P.displayName="GeneratorFunction",s.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===P||"GeneratorFunction"===(t.displayName||t.name))},s.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,O):(e.__proto__=O,i in e||(e[i]="GeneratorFunction")),e.prototype=Object.create(m),e},s.awrap=function(e){return{__await:e}},k(C.prototype),C.prototype[n]=function(){return this},s.AsyncIterator=C,s.async=function(e,t,r,n){var a=new C(g(e,t,r,n));return s.isGeneratorFunction(t)?a:a.next().then(function(e){return e.done?e.value:a.next()})},k(m),m[i]="Generator",m[a]=function(){return this},m.toString=function(){return"[object Generator]"},s.keys=function(r){var n=[];for(var e in r)n.push(e);return n.reverse(),function e(){for(;n.length;){var t=n.pop();if(t in r)return e.value=t,e.done=!1,e}return e.done=!0,e}},s.values=I,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(A),!e)for(var t in this)"t"===t.charAt(0)&&l.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=u)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var n=this;function e(e,t){return i.type="throw",i.arg=r,n.next=e,t&&(n.method="next",n.arg=u),!!t}for(var t=this.tryEntries.length-1;0<=t;--t){var a=this.tryEntries[t],i=a.completion;if("root"===a.tryLoc)return e("end");if(a.tryLoc<=this.prev){var o=l.call(a,"catchLoc"),s=l.call(a,"finallyLoc");if(o&&s){if(this.prev<a.catchLoc)return e(a.catchLoc,!0);if(this.prev<a.finallyLoc)return e(a.finallyLoc)}else if(o){if(this.prev<a.catchLoc)return e(a.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return e(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;0<=r;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&l.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var a=n;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,v):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),A(r),v}},catch:function(e){for(var t=this.tryEntries.length-1;0<=t;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var a=n.arg;A(r)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:I(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=u),v}}}function g(e,t,r,n){var i,o,s,u,a=t&&t.prototype instanceof w?t:w,l=Object.create(a.prototype),c=new N(n||[]);return l._invoke=(i=e,o=r,s=c,u=f,function(e,t){if(u===h)throw new Error("Generator is already running");if(u===p){if("throw"===e)throw t;return R()}for(s.method=e,s.arg=t;;){var r=s.delegate;if(r){var n=S(r,s);if(n){if(n===v)continue;return n}}if("next"===s.method)s.sent=s._sent=s.arg;else if("throw"===s.method){if(u===f)throw u=p,s.arg;s.dispatchException(s.arg)}else"return"===s.method&&s.abrupt("return",s.arg);u=h;var a=_(i,o,s);if("normal"===a.type){if(u=s.done?p:d,a.arg===v)continue;return{value:a.arg,done:s.done}}"throw"===a.type&&(u=p,s.method="throw",s.arg=a.arg)}}),l}function _(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}function w(){}function P(){}function O(){}function k(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function C(u){var t;this._invoke=function(r,n){function e(){return new Promise(function(e,t){!function t(e,r,n,a){var i=_(u[e],u,r);if("throw"!==i.type){var o=i.arg,s=o.value;return s&&"object"==typeof s&&l.call(s,"__await")?Promise.resolve(s.__await).then(function(e){t("next",e,n,a)},function(e){t("throw",e,n,a)}):Promise.resolve(s).then(function(e){o.value=e,n(o)},function(e){return t("throw",e,n,a)})}a(i.arg)}(r,n,e,t)})}return t=t?t.then(e,e):e()}}function S(e,t){var r=e.iterator[t.method];if(r===u){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=u,S(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var n=_(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,v;var a=n.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=u),t.delegate=null,v):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function N(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function I(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,n=function e(){for(;++r<t.length;)if(l.call(t,r))return e.value=t[r],e.done=!1,e;return e.value=u,e.done=!0,e};return n.next=n}}return{next:R}}function R(){return{value:u,done:!0}}}(function(){return this||"object"==typeof self&&self}()||Function("return this")())},{}]},{},[13])(13)});